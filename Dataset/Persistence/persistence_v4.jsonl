{"id": "T1547.001_artifact_001", "input": "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run 아래에 새 값이 추가되었는데, 데이터가 C:\\Users\\<USER>\\AppData\\Local\\Temp\\updater.exe를 가리킨다. 해당 EXE는 서명이 없고, 같은 시간대에 설치 로그나 정식 프로그램 추가 기록은 없다. 부팅 후마다 이 파일에서 시작된 프로세스가 반복적으로 나타난다.", "label_tid": "T1547.001", "label_mid": "Persistence_RunKey", "label_risk": "Malicious"}
{"id": "T1547.001_artifact_002", "input": "HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run 경로에 알 수 없는 이름의 값이 생성되었고, 값 데이터는 C:\\ProgramData\\<RANDOM>\\svc.exe를 지정하고 있다. 이 실행 파일은 최근에만 생성된 것으로 보이며, Prefetch와 MFT 타임라인을 보면 사용자 로그인 직후마다 실행된 기록이 잇따른다.", "label_tid": "T1547.001", "label_mid": "Persistence_RunKey", "label_risk": "Malicious"}
{"id": "T1547.001_artifact_003", "input": "RunOnce 키에 rundll32.exe와 함께 호출되는 DLL 경로가 등록되었는데, DLL 파일은 숨김 속성이 설정된 로컬 폴더에 있다. 이 DLL은 같은 날짜에 여러 번 교체된 흔적이 있고, 정식 제품 설치 디렉터리와도 무관하다.", "label_tid": "T1547.001", "label_mid": "Persistence_RunKey", "label_risk": "Malicious"}
{"id": "T1547.001_artifact_004", "input": "사용자 계정이 처음 로그인한 직후 HKCU Run 키에 스크립트 파일을 wscript.exe로 실행하는 항목이 추가되었다. 스크립트는 Downloads 하위에 있으며, 실행 후 바로 삭제되도록 작성되어 있어 지속성 확보를 위한 악성 구성으로 의심된다.", "label_tid": "T1547.001", "label_mid": "Persistence_RunKey", "label_risk": "Malicious"}
{"id": "T1547.001_artifact_005", "input": "정상적으로 사용되지 않는 테스트용 워크스테이션에서 Run 키가 C:\\Windows\\Tasks\\tmp.exe를 자동 실행하도록 변경되어 있었다. tmp.exe는 최근 외부 저장소에서 복사된 것으로 보이고, 이후 이 파일을 기점으로 추가 프로세스들이 여러 개 생성된 흔적이 있다.", "label_tid": "T1547.001", "label_mid": "Persistence_RunKey", "label_risk": "Malicious"}
{"id": "T1547.001_artifact_006", "input": "백업 솔루션 설치 후 HKLM Run 경로에 벤더 문서에 명시된 백업 에이전트가 등록되었다. 값 데이터는 C:\\Program Files\\<VENDOR>\\Backup\\backuptray.exe를 가리키며, 설치 이벤트 로그와 MSI 설치 기록이 같은 시각에 남아 있다. 이후 이 프로세스는 예약된 백업 시간에만 동작한다.", "label_tid": "T1547.001", "label_mid": "Persistence_RunKey", "label_risk": "Benign"}
{"id": "T1547.001_artifact_007", "input": "업무용 메신저 프로그램 업데이트 이후 HKCU Run 키에 기존 자동 실행 항목이 새 경로로 갱신되었다. 경로는 Program Files\\<VENDOR>\\Messenger\\ 폴더이며, 프로그램 추가/제거 목록과 버전 정보가 모두 일치한다. 사용자는 평소 자동 로그인 기능을 사용해 왔다.", "label_tid": "T1547.001", "label_mid": "Persistence_RunKey", "label_risk": "Benign"}
{"id": "T1547.001_artifact_008", "input": "클라우드 동기화 클라이언트를 설치하면서 Run 키에 동기화 프로세스가 등록되었다. 레지스트리 값 이름과 데이터는 공급사 가이드와 동일하고, Prefetch에도 해당 클라이언트가 부팅 직후 한 번만 실행된 흔적이 있을 뿐 추가적인 의심 정황은 없다.", "label_tid": "T1547.001", "label_mid": "Persistence_RunKey", "label_risk": "Benign"}
{"id": "T1547.001_artifact_009", "input": "조직 표준 이미지 배포 스크립트가 실행된 날, HKLM Run 아래에 EDR 에이전트 자동 실행 항목이 일괄 등록되었다. 실행 파일 경로는 C:\\Program Files\\<VENDOR>\\Agent\\agent.exe이고, 서명이 유효하며 중앙 관리 서버와의 정상 통신 로그도 확인된다.", "label_tid": "T1547.001", "label_mid": "Persistence_RunKey", "label_risk": "Benign"}
{"id": "T1547.001_artifact_010", "input": "정기 점검 기간 동안 시스템 관리자가 레지스트리 편집기를 통해 인벤토리 수집 도구를 Run 키에 추가한 기록이 있다. 해당 도구는 내부에서 사용하는 자산 관리 프로그램으로, 설치 경로와 파일 해시가 기존 기준값과 동일하다.", "label_tid": "T1547.001", "label_mid": "Persistence_RunKey", "label_risk": "Benign"}
{"id": "T1547.001_artifact_011", "input": "HKCU Run에 새 항목 하나가 보이는데, 값 데이터가 C:\\Program Files\\<UNKNOWN>\\app.exe를 가리킨다. 파일 자체는 정상적인 구조를 가진 PE로 보이지만, 조직 내 승인된 소프트웨어 목록에는 이 벤더 이름이 없다. 새로 도입된 정상 프로그램인지, 위장된 악성인지 아직 구분하기 어렵다.", "label_tid": "T1547.001", "label_mid": "Persistence_RunKey", "label_risk": "Suspicious"}
{"id": "T1547.001_artifact_012", "input": "Run 키 값 이름과 설명은 운영체제 기본 구성 요소와 비슷하지만, 실제 실행 경로는 데이터 전용 드라이브의 별도 폴더를 가리킨다. 설치 로그와 MSI 기록을 확인했을 때 이 경로를 사용하는 정식 설치 내역은 보이지 않는다.", "label_tid": "T1547.001", "label_mid": "Persistence_RunKey", "label_risk": "Suspicious"}
{"id": "T1547.001_artifact_013", "input": "StartUp 관련 문제를 조사하던 중, Run 키에 등록된 항목 하나가 간헐적으로만 실행되는 것이 확인되었다. 실행 파일은 Program Files와 유사한 이름의 폴더에 있으나, 버전 정보와 파일 설명이 비어 있어서 잘못 배포된 내부 도구인지 악성 코드인지 애매한 상태다.", "label_tid": "T1547.001", "label_mid": "Persistence_RunKey", "label_risk": "Suspicious"}
{"id": "T1547.001_artifact_014", "input": "레지스트리 감사 이벤트를 보면 Run 값이 한 번 변경된 기록은 있으나, 이전 값이 무엇이었는지를 보여주는 상세 정보가 남아 있지 않다. 현재 값은 정상 프로그램을 가리키고 있지만, 과거에 다른 경로를 사용했는지 여부를 확정할 수 없다.", "label_tid": "T1547.001", "label_mid": "Persistence_RunKey", "label_risk": "Suspicious"}
{"id": "T1547.001_artifact_015", "input": "사용자가 불만을 제기한 자동 실행 문제를 확인하는 과정에서 Run 키의 특정 값이 최근에 추가된 사실이 드러났다. 다만 실행 파일은 정상 서명이 있고, 추가적인 악성 행위도 관찰되지 않아 운영상의 설정 변경인지 초기 침투 징후인지는 아직 판단하기 어렵다.", "label_tid": "T1547.001", "label_mid": "Persistence_RunKey", "label_risk": "Suspicious"}
{"id": "T1547.001_artifact_016", "input": "분석 대상 기간 동안 HKCU와 HKLM의 Run 관련 키를 확인했지만, 백업된 NTUSER.DAT와 SYSTEM 하이브가 일부 손상되어 과거 값 변화를 완전히 추적할 수 없다. Run 기반 지속성이 실제로 사용되었는지 판단하려면 이전 시점의 레지스트리 백업, 이벤트 로그의 레지스트리 변경 이벤트(예: 4657), 그리고 관련 실행 파일의 MFT 타임라인을 추가로 확보해야 한다.", "label_tid": "T1547.001", "label_mid": "Persistence_RunKey", "label_risk": "Unknown"}
{"id": "T1547.001_artifact_017", "input": "현재 Run 키에는 의심스러운 값이 보이지 않지만, 레지스트리 트랜잭션 로그(*.LOG1, *.LOG2)가 오래된 백업으로 덮어써져 과거 변경 내역을 확인하기 어렵다. 악성 항목이 생성되었다가 삭제된 사례를 확인하려면, 동일 시점의 SYSTEM/NTUSER 하이브 이미지와 USN Journal에서 관련 실행 파일의 생성·삭제 기록을 추가로 확인해야 한다.", "label_tid": "T1547.001", "label_mid": "Persistence_RunKey", "label_risk": "Unknown"}
{"id": "T1547.001_artifact_018", "input": "시스템 복원 기능이 여러 차례 사용된 탓에 일부 Run 관련 레지스트리 키가 이전 상태로 되돌려졌다. 복원 전 어떤 값들이 존재했는지 알 수 없어서 유지보수 작업인지 공격자가 흔적을 지운 것인지 구분이 되지 않는다. 판단을 위해서는 복원 지점 생성 시점의 레지스트리 백업, Windows Backup 이미지, 그리고 해당 시기 Prefetch/Amcache 기록을 함께 분석해야 한다.", "label_tid": "T1547.001", "label_mid": "Persistence_RunKey", "label_risk": "Unknown"}
{"id": "T1547.001_artifact_019", "input": "획득한 증거 세트에는 Run 키가 덤프된 텍스트만 포함되어 있고, 언제 어떤 값이 추가·변경되었는지에 대한 타임라인 정보는 없다. Run 기반 지속성이 사용되었는지 확인하려면 원본 하이브 파일, 레지스트리 감사 로그, 그리고 Task Scheduler나 서비스 구성처럼 다른 자동 실행 지점과의 상관관계를 추가로 확인해야 한다.", "label_tid": "T1547.001", "label_mid": "Persistence_RunKey", "label_risk": "Unknown"}
{"id": "T1547.001_artifact_020", "input": "디스크 이미지를 획득하기 전에 사용자가 여러 차례 레지스트리를 청소하는 도구를 실행해 Run 키 일부가 제거된 상태다. 도구 실행 이전에 어떤 값이 존재했는지는 알 수 없다. Run 키를 통한 지속성 여부를 평가하려면, 백업된 하이브, 시스템 복원 지점의 레지스트리, 그리고 해당 기간의 이벤트 로그를 추가 확보해야 한다.", "label_tid": "T1547.001", "label_mid": "Persistence_RunKey", "label_risk": "Unknown"}
{"id": "T1574.002_artifact_001", "input": "업무용 프로그램 실행 시, 원래는 System32 경로에서 로드되어야 할 DLL 이름과 동일한 파일이 사용자 프로필 하위 비표준 폴더에서 먼저 로드된 것이 확인되었다. 이 DLL은 서명이 없고 최근에만 생성되었으며, MFT 타임라인 기준으로 프로그램 설치 시점과 무관하게 별도로 복사된 흔적이 있다.", "label_tid": "T1574.002", "label_mid": "Persistence_DLLHijack", "label_risk": "Malicious"}
{"id": "T1574.002_artifact_002", "input": "특정 서비스의 실행 파일과 같은 디렉터리에, 동일 이름의 DLL이 새로 생성되었다. 원래 제품 설치 경로에는 해당 DLL이 존재하지 않으며, 새 DLL 파일 안에는 추가적인 명령 실행 코드가 포함되어 있다. 서비스 시작 시마다 이 악성 DLL이 함께 로드된 흔적이 이벤트 로그와 Prefetch에서 반복적으로 확인된다.", "label_tid": "T1574.002", "label_mid": "Persistence_DLLHijack", "label_risk": "Malicious"}
{"id": "T1574.002_artifact_003", "input": "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\KnownDLLs 설정을 보면, 특정 DLL 이름의 경로가 기본 System32가 아닌 별도의 로컬 폴더를 가리키도록 변경되어 있었다. 변경 직후부터 여러 프로세스에서 동일한 비정상 경로의 DLL을 참조하는 기록이 나타난다.", "label_tid": "T1574.002", "label_mid": "Persistence_DLLHijack", "label_risk": "Malicious"}
{"id": "T1574.002_artifact_004", "input": "사용자 계정이 자주 사용하는 GUI 프로그램 설치 폴더 안에, 원래는 없어야 할 공통 DLL 이름이 추가되어 있었다. 이 DLL은 다른 시스템에서 복사된 것이 아니라, 악성 설치 파일에 의해 한 번에 여러 호스트에 전파된 것으로 보이며, 실행 시마다 동일한 외부 툴을 추가로 시작하는 기능을 포함한다.", "label_tid": "T1574.002", "label_mid": "Persistence_DLLHijack", "label_risk": "Malicious"}
{"id": "T1574.002_artifact_005", "input": "한 번도 업데이트되지 않던 오래된 응용프로그램 디렉터리에, 갑자기 기존 DLL과 동일한 파일명으로 크기가 다른 DLL이 등장했다. 이전 버전 DLL은 삭제되었고, 새 DLL 내부에는 추가된 스케줄링 코드가 있어 사용자가 프로그램만 실행해도 정기적으로 악성 작업이 유지되도록 설계되어 있다.", "label_tid": "T1574.002", "label_mid": "Persistence_DLLHijack", "label_risk": "Malicious"}
{"id": "T1574.002_artifact_006", "input": "공식 벤더 서명이 포함된 업데이트 패키지를 적용한 결과, 제품 설치 폴더 내 여러 DLL이 새 버전으로 교체되었다. 모든 DLL은 Program Files 하위 정규 경로에 위치하며, 파일 버전 정보와 해시값이 공급사에서 제공한 목록과 일치한다. 추가적인 비정상 동작은 관찰되지 않는다.", "label_tid": "T1574.002", "label_mid": "Persistence_DLLHijack", "label_risk": "Benign"}
{"id": "T1574.002_artifact_007", "input": "그래픽 드라이버 소프트웨어를 재설치하는 과정에서 기존 DLL들이 새 버전으로 바뀌었다. 설치 로그와 SetupAPI 기록을 보면 동일한 패키지가 여러 호스트에 반복 배포되었고, 교체된 DLL들은 모두 벤더 서명과 정상 버전 정보를 가진다.", "label_tid": "T1574.002", "label_mid": "Persistence_DLLHijack", "label_risk": "Benign"}
{"id": "T1574.002_artifact_008", "input": "로컬 프린터 드라이버 업데이트 후 인쇄 관련 응용프로그램 설치 폴더에 새로운 DLL이 추가되었다. 해당 DLL은 벤더 문서에 언급된 확장 기능 모듈이며, 파일 경로와 이름이 문서에서 제시한 값과 정확히 일치한다. 이후 타임라인에서도 특이한 실행 패턴은 없다.", "label_tid": "T1574.002", "label_mid": "Persistence_DLLHijack", "label_risk": "Benign"}
{"id": "T1574.002_artifact_009", "input": "내부에서 개발한 업무용 툴을 새 버전으로 교체하면서, 이전 버전 DLL 여러 개가 삭제되고 새 DLL이 같은 경로에 배치되었다. 변경 이력과 소스 코드 저장소 기록이 일치하고, 배포 작업은 개발 담당자가 지정된 시간에 직접 수행하였다.", "label_tid": "T1574.002", "label_mid": "Persistence_DLLHijack", "label_risk": "Benign"}
{"id": "T1574.002_artifact_010", "input": "운영팀이 시스템 최적화 작업을 하면서 한 응용프로그램의 플러그인 DLL을 제거하고 새 플러그인을 추가했다. 이 플러그인은 단순 UI 확장 기능을 제공하며, 다른 프로세스에서 예기치 못한 로드 패턴이나 추가 실행 행위는 보이지 않는다.", "label_tid": "T1574.002", "label_mid": "Persistence_DLLHijack", "label_risk": "Benign"}
{"id": "T1574.002_artifact_011", "input": "Program Files 하위 한 응용프로그램 폴더에서 원본 설치 미디어에 존재하지 않는 DLL 하나가 발견되었다. 파일명은 일반적인 시스템 DLL 이름과 비슷하지만, 내부 버전 정보가 비어 있고 서명도 없다. 다만 이 DLL이 실제로 로드되었는지를 보여주는 Prefetch나 로딩 이력은 제한적으로만 확인된다.", "label_tid": "T1574.002", "label_mid": "Persistence_DLLHijack", "label_risk": "Suspicious"}
{"id": "T1574.002_artifact_012", "input": "한 프로그램이 실행될 때마다 항상 같은 로컬 폴더에서 특정 DLL을 찾으려고 시도하지만, 그 경로에는 실제 DLL 파일이 존재하지 않는다. 이 경로는 검색 순서 상 먼저 확인되는 위치라 공격자가 악성 DLL을 심어둘 수 있는 여지가 있으나, 현재 시점에는 실제 악성 파일이 놓인 흔적은 없다.", "label_tid": "T1574.002", "label_mid": "Persistence_DLLHijack", "label_risk": "Suspicious"}
{"id": "T1574.002_artifact_013", "input": "KnownDLLs 구성에서 일부 항목의 순서가 변경된 기록이 있지만, 현재 값들은 모두 System32 경로를 가리킨다. 과거에 비정상 경로가 설정되었는지 여부를 확정할 수 있는 이전 하이브나 상세 변경 로그는 없다. 설정 변경이 성능 튜닝이었는지 악성 시도였는지 판단하기 어렵다.", "label_tid": "T1574.002", "label_mid": "Persistence_DLLHijack", "label_risk": "Suspicious"}
{"id": "T1574.002_artifact_014", "input": "사용자가 자주 실행하는 구버전 프로그램 폴더에, 다른 시스템에서 복사해온 것으로 추정되는 DLL이 하나 추가되어 있다. 이 DLL은 공식 서명이 없지만, 아직 이 파일이 실제로 로드되거나 악성 동작을 수행했다는 증거는 로그에서 발견되지 않았다.", "label_tid": "T1574.002", "label_mid": "Persistence_DLLHijack", "label_risk": "Suspicious"}
{"id": "T1574.002_artifact_015", "input": "특정 응용프로그램이 시작될 때마다 로딩 실패 이벤트가 발생하며 없는 DLL을 찾고 있다는 경고가 남는다. 이 경로가 공격에 악용될 수는 있지만, 현재는 해당 위치에 어떠한 DLL 파일도 존재하지 않고, 실제 악용 시도가 있었는지는 확인되지 않는다.", "label_tid": "T1574.002", "label_mid": "Persistence_DLLHijack", "label_risk": "Suspicious"}
{"id": "T1574.002_artifact_016", "input": "획득한 디스크 이미지에는 일부 응용프로그램 폴더 구조만 남아 있고 DLL 파일 대부분은 이미 제거된 상태다. 과거에 DLL 하이재킹이 있었는지 확인하기에는 정보가 부족하다. 판단을 위해서는 같은 시점의 전체 디스크 백업, Prefetch/Amcache에서의 DLL 로딩 흔적, 그리고 해당 응용프로그램 관련 이벤트 로그를 추가로 확보해야 한다.", "label_tid": "T1574.002", "label_mid": "Persistence_DLLHijack", "label_risk": "Unknown"}
{"id": "T1574.002_artifact_017", "input": "KnownDLLs 및 App Paths 레지스트리 키가 손상된 백업본에서 복원된 바 있어, 과거에 어떤 DLL 경로가 설정되어 있었는지 완전히 알 수 없다. DLL 하이재킹이 실제로 발생했는지 평가하려면 이전 SYSTEM 하이브, 레지스트리 트랜잭션 로그, 그리고 해당 기간의 설치·제거 이벤트 로그를 추가 확인해야 한다.", "label_tid": "T1574.002", "label_mid": "Persistence_DLLHijack", "label_risk": "Unknown"}
{"id": "T1574.002_artifact_018", "input": "분석 대상 구간에서 특정 DLL 파일이 여러 번 생성·삭제된 흔적은 있으나, 어떤 프로세스가 이 DLL을 로드했는지 알 수 있는 프로세스 모니터링 로그는 수집되지 않았다. 이 DLL이 검색 순서를 악용한 하이재킹 용도였는지 확인하려면, 동일 시점의 추가 디스크 이미지, 더 상세한 파일 액세스 로그, 그리고 다른 호스트의 비교 데이터가 필요하다.", "label_tid": "T1574.002", "label_mid": "Persistence_DLLHijack", "label_risk": "Unknown"}
{"id": "T1574.002_artifact_019", "input": "레지스트리와 파일 시스템을 살펴봤을 때, DLL 검색 순서를 조작한 명백한 설정은 보이지 않는다. 다만 일부 로그가 비어 있어 이전에 비정상 경로가 설정되었다가 되돌려졌는지 여부는 알 수 없다. 보다 정확한 판단을 위해서는 과거 레지스트리 백업, 설치 이력 로그, 그리고 해당 앱 실행 시점의 상세 타임라인이 필요하다.", "label_tid": "T1574.002", "label_mid": "Persistence_DLLHijack", "label_risk": "Unknown"}
{"id": "T1574.002_artifact_020", "input": "사용되던 응용프로그램이 이미 제거된 뒤의 디스크 이미지만 확보되어 있어, 설치 당시 DLL 배치 방식이나 검색 경로 설정을 복원할 수 없다. DLL 하이재킹 여부를 분석하려면 제거 이전에 수집된 시스템 스냅샷, 백업된 프로그램 디렉터리, 그리고 당시의 실행 관련 로그가 추가로 필요하다.", "label_tid": "T1574.002", "label_mid": "Persistence_DLLHijack", "label_risk": "Unknown"}
{"id": "T1543.003_artifact_001", "input": "서비스 레지스트리에 새 항목이 최근에 추가되었고, ImagePath가 C:\\ProgramData 하위의 알 수 없는 폴더를 가리킨다. 이 실행 파일은 서명이 없고 설치 관련 로그도 없다. 서비스 시작 유형은 자동으로 설정되어 부팅 때마다 실행된다.", "label_tid": "T1543.003", "label_mid": "Persistence_Service", "label_risk": "Malicious"}
{"id": "T1543.003_artifact_002", "input": "명령줄 도구를 통해 비인가 서비스 하나가 등록되었다. ImagePath는 사용자 프로필의 Temp 하위 EXE를 가리키며, 같은 시각 사용자 활동 로그는 비어 있다. 이후에도 해당 서비스는 주기적으로 재시작되는 패턴을 보인다.", "label_tid": "T1543.003", "label_mid": "Persistence_Service", "label_risk": "Malicious"}
{"id": "T1543.003_artifact_003", "input": "정상 서비스와 거의 동일한 이름으로 위장된 서비스가 생성되었지만, 실행 파일 위치는 숨김 속성이 설정된 로컬 폴더였다. 새 서비스 등록 직후부터 이 파일에서 파생된 자식 프로세스가 비정상적으로 여러 번 생성된 기록이 있다.", "label_tid": "T1543.003", "label_mid": "Persistence_Service", "label_risk": "Malicious"}
{"id": "T1543.003_artifact_004", "input": "특정 서비스의 ImagePath가 원래 제품 설치 경로가 아닌 이름만 비슷한 다른 EXE로 교체되어 있었다. 새 경로는 Program Files와 무관한 독립 디렉터리이며, 변경 직후의 이벤트 로그 일부는 삭제된 상태다.", "label_tid": "T1543.003", "label_mid": "Persistence_Service", "label_risk": "Malicious"}
{"id": "T1543.003_artifact_005", "input": "부팅 단계에서 자동 실행되는 새 서비스가 발견되었고, 실행 파일은 일반적인 시스템 디렉터리가 아니라 사용자가 직접 접근하기 어려운 폴더에 위치해 있다. 이 서비스는 수동으로 중지해도 잠시 뒤 다시 실행 상태로 돌아온다.", "label_tid": "T1543.003", "label_mid": "Persistence_Service", "label_risk": "Malicious"}
{"id": "T1543.003_artifact_006", "input": "제품 업데이트 직후 백업 솔루션용 서비스가 새로 추가되었다. 실행 파일은 C:\\Program Files\\<VENDOR>\\Backup 경로에 있고, MSI 설치 로그와 서비스 생성 이벤트 시각이 정확히 일치한다. 동작 내용도 정기 백업 작업과만 관련된다.", "label_tid": "T1543.003", "label_mid": "Persistence_Service", "label_risk": "Benign"}
{"id": "T1543.003_artifact_007", "input": "관리 콘솔에서 배포한 모니터링 에이전트가 시스템에 서비스를 등록했다. 실행 파일은 공식 서명이 있는 에이전트 바이너리이며, 조직에서 승인한 패키지의 문서에 동일한 서비스 이름과 경로가 명시되어 있다.", "label_tid": "T1543.003", "label_mid": "Persistence_Service", "label_risk": "Benign"}
{"id": "T1543.003_artifact_008", "input": "보안 솔루션 업그레이드 과정에서 이전 서비스가 제거되고 새 이름의 서비스가 자동으로 생성되었다. 프로그램 추가/제거 항목과 이벤트 로그 모두 같은 버전으로의 업그레이드를 기록하고 있으며, 파일 경로도 보안 제품 설치 디렉터리와 일치한다.", "label_tid": "T1543.003", "label_mid": "Persistence_Service", "label_risk": "Benign"}
{"id": "T1543.003_artifact_009", "input": "정기 점검 시간대에 서버 관리자가 장비 제어용 서비스를 수동 추가하였다. 서비스 설명과 실행 파일 경로는 공급사 기술 문서에 제시된 예제와 동일하고, 변경 관리 티켓에도 같은 작업이 기록되어 있다.", "label_tid": "T1543.003", "label_mid": "Persistence_Service", "label_risk": "Benign"}
{"id": "T1543.003_artifact_010", "input": "하드웨어 관리 프로그램 설치 시 전용 서비스가 자동 등록되었다. SetupAPI 로그, OS 이벤트 로그, 설치 디렉터리 구조를 보면 정상 설치 절차를 따른 것으로 보이며, 서비스는 장치 상태 수집 외 다른 동작은 수행하지 않는다.", "label_tid": "T1543.003", "label_mid": "Persistence_Service", "label_risk": "Benign"}
{"id": "T1543.003_artifact_011", "input": "새 서비스 항목 하나가 발견되었지만, 제품 목록에서 해당 프로그램을 찾을 수 없다. 실행 파일은 Program Files와 유사한 이름의 폴더에 위치해 있어 미승인 소프트웨어일 수도 있고 정식 제품의 옛 버전일 수도 있다.", "label_tid": "T1543.003", "label_mid": "Persistence_Service", "label_risk": "Suspicious"}
{"id": "T1543.003_artifact_012", "input": "서비스 이름과 설명은 운영 체제 기본 구성 요소와 비슷하지만, ImagePath는 데이터 드라이브 하위의 독립 경로를 가리킨다. 설치 시점을 보여줄 설치 로그가 남아 있지 않아 새로 도입된 관리 도구인지 악성 구성이었는지 확실치 않다.", "label_tid": "T1543.003", "label_mid": "Persistence_Service", "label_risk": "Suspicious"}
{"id": "T1543.003_artifact_013", "input": "Start 값이 수동으로 설정된 서비스가 간헐적으로만 실행되는 게 관찰되었다. 파일 구조는 일반적인 응용프로그램과 비슷하지만 버전 정보와 서명이 없어, 잘못 등록된 정상 프로그램인지 악용된 구성인지 모호하다.", "label_tid": "T1543.003", "label_mid": "Persistence_Service", "label_risk": "Suspicious"}
{"id": "T1543.003_artifact_014", "input": "서비스 구성 변경 이력이 일부 삭제되어 이전 ImagePath가 무엇이었는지 확인되지 않는다. 현재 구성만 보면 정상 서비스처럼 보이지만, 과거에 악성 경로를 가리켰다가 정리되었을 가능성을 완전히 배제할 수는 없다.", "label_tid": "T1543.003", "label_mid": "Persistence_Service", "label_risk": "Suspicious"}
{"id": "T1543.003_artifact_015", "input": "최근 생성된 서비스 하나가 자동 시작으로 설정되어 있지만, 실행 파일의 용도가 불명확하다. 악성 지표는 보이지 않으나 조직 내 승인 목록에도 없어서 신규 도입 소프트웨어인지 공격 흔적인지 판단이 애매한 상태다.", "label_tid": "T1543.003", "label_mid": "Persistence_Service", "label_risk": "Suspicious"}
{"id": "T1543.003_artifact_016", "input": "분석 대상 기간 동안 서비스 제어 관리자 이벤트와 레지스트리 백업을 확인했지만, 새로 생성된 서비스 항목이 있었는지는 확실하지 않다. 정확한 판단을 위해 이전 시점의 SYSTEM 하이브, Service Control Manager 7045 이벤트 로그, 그리고 서비스 실행 파일 후보의 USN Journal 생성 기록을 추가로 확보해야 한다.", "label_tid": "T1543.003", "label_mid": "Persistence_Service", "label_risk": "Unknown"}
{"id": "T1543.003_artifact_017", "input": "서비스 관련 레지스트리 하이브 일부가 복구본으로 대체되어 과거 어떤 구성이 있었는지 알 수 없다. 악성 서비스가 존재했는지 평가하려면 레지스트리 백업본의 SYSTEM 하이브, SetupAPI 설치 로그, 그리고 당시 디스크의 MFT 스냅샷이 필요하다.", "label_tid": "T1543.003", "label_mid": "Persistence_Service", "label_risk": "Unknown"}
{"id": "T1543.003_artifact_018", "input": "로그 손실로 인해 서비스 생성·제거 이력이 비어 있다. 과거에 악성 서비스가 추가되었다가 삭제되었는지 확인하려면 USN Journal에서 관련 실행 파일의 생성·삭제 흔적, 레지스트리 트랜잭션 로그(*.LOG1, *.LOG2), 그리고 ImagePath 경로의 MFT 타임라인을 추가로 분석해야 한다.", "label_tid": "T1543.003", "label_mid": "Persistence_Service", "label_risk": "Unknown"}
{"id": "T1543.003_artifact_019", "input": "백업에서 추출한 레지스트리에는 서비스 항목 일부만 포함되어 있어 당시 전체 서비스를 재구성할 수 없다. 판단을 위해서는 동일 시점의 완전한 SYSTEM 하이브, Evtx의 Service Installed 이벤트, 그리고 서비스 실행 파일의 생성·수정 시간을 함께 확인해야 한다.", "label_tid": "T1543.003", "label_mid": "Persistence_Service", "label_risk": "Unknown"}
{"id": "T1543.003_artifact_020", "input": "시스템이 여러 차례 재설치되어 현재 서비스 구성은 과거와 전혀 다르다. 과거에 서비스 기반 지속성이 사용되었는지 확인하려면 이전 디스크 이미지, 당시의 레지스트리 백업(SYSTEM 하이브), 그리고 SetupAPI.dev.log에 남은 서비스 설치 흔적을 확보해야 한다.", "label_tid": "T1543.003", "label_mid": "Persistence_Service", "label_risk": "Unknown"}
{"id": "T1546.010_artifact_001", "input": "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Windows 키의 AppInit_DLLs 값에, 기존에 없던 DLL 경로가 추가되었다. 이 DLL은 C:\\Users\\<USER>\\AppData\\Local\\Temp 하위에 위치하고 서명도 없으며, 최근에만 생성된 것으로 보인다. LoadAppInit_DLLs 값은 1로 설정되어 있어 해당 DLL이 여러 GUI 프로세스에 주입될 수 있는 상태다.", "label_tid": "T1546.010", "label_mid": "Persistence_AppInit_DLLs", "label_risk": "Malicious"}
{"id": "T1546.010_artifact_002", "input": "조사 시점 기준 AppInit_DLLs에는 두 개의 DLL 경로가 등록되어 있는데, 그중 하나는 ProgramData 하위 난수형 디렉터리에 있는 파일을 가리킨다. 이 DLL은 정식 제품 설치 경로와 무관하고, MFT 타임라인상 공격 의심 시점에 맞춰 복사된 흔적이 있으며, 이후 여러 사용자 세션에서 동일 DLL이 반복 로드된 흔적이 남아 있다.", "label_tid": "T1546.010", "label_mid": "Persistence_AppInit_DLLs", "label_risk": "Malicious"}
{"id": "T1546.010_artifact_003", "input": "LoadAppInit_DLLs 값이 0에서 1로 변경된 직후, AppInit_DLLs 값에 비표준 경로의 DLL 하나가 추가되었다. 이 DLL을 참조하는 프로세스들은 원래 AppInit을 사용하지 않던 상용 프로그램들인데, 해당 DLL 로딩 직후부터 비정상적인 자식 프로세스 생성 패턴이 관찰된다.", "label_tid": "T1546.010", "label_mid": "Persistence_AppInit_DLLs", "label_risk": "Malicious"}
{"id": "T1546.010_artifact_004", "input": "AppInit_DLLs에 등록된 DLL 파일이 최근에 여러 차례 교체되었다. 이전 버전 DLL은 삭제되고, 같은 이름을 가진 새 DLL이 동일 경로에 반복적으로 덮어써졌다. 각 교체 직후마다 사용자 로그온 이벤트 뒤를 이어 의심스러운 파일 접근과 프로세스 생성 타임라인이 나타난다.", "label_tid": "T1546.010", "label_mid": "Persistence_AppInit_DLLs", "label_risk": "Malicious"}
{"id": "T1546.010_artifact_005", "input": "한 번도 AppInit DLL을 사용하지 않던 워크스테이션에서, 갑자기 AppInit_DLLs와 LoadAppInit_DLLs 값이 함께 설정된 것이 발견되었다. 등록된 DLL은 숨김 속성으로 지정된 로컬 폴더에 있으며, 다른 시스템에서는 동일 파일이 관찰되지 않아 공격자가 특정 호스트에만 주입용 DLL을 심어둔 것으로 보인다.", "label_tid": "T1546.010", "label_mid": "Persistence_AppInit_DLLs", "label_risk": "Malicious"}
{"id": "T1546.010_artifact_006", "input": "그래픽 드라이버 제조사가 제공하는 정식 제어판 소프트웨어를 설치한 뒤, 벤더 문서에 기재된 대로 AppInit_DLLs에 해당 벤더 DLL이 등록되었다. DLL 경로는 C:\\Windows\\System32\\<VENDOR>.dll이며, RequireSignedAppInit_DLLs 값이 1로 설정되어 있고, 파일에는 유효한 서명이 포함되어 있다. 추가적인 악성 행위는 관찰되지 않는다.", "label_tid": "T1546.010", "label_mid": "Persistence_AppInit_DLLs", "label_risk": "Benign"}
{"id": "T1546.010_artifact_007", "input": "특정 보안 제품이 GUI 프로세스를 모니터링하기 위해 AppInit DLL을 사용하는 구성으로 배포되었다. AppInit_DLLs 값에는 C:\\Program Files\\<VENDOR>\\Agent\\agentshim.dll만 등록되어 있고, LoadAppInit_DLLs와 RequireSignedAppInit_DLLs 설정도 공급사 가이드와 동일하다. 이벤트 로그와 제품 문서 모두 이를 정상 동작으로 설명하고 있다.", "label_tid": "T1546.010", "label_mid": "Persistence_AppInit_DLLs", "label_risk": "Benign"}
{"id": "T1546.010_artifact_008", "input": "오래된 업무용 프로그램이 Windows 10 호환성을 위해 업데이트되면서, 공식 패치 노트에 따라 AppInit_DLLs 값에 호환성 레이어용 DLL이 추가되었다. DLL은 Program Files 하위 설치 디렉터리에 위치하며, 파일 해시와 버전 정보가 벤더에서 제공한 값과 일치한다.", "label_tid": "T1546.010", "label_mid": "Persistence_AppInit_DLLs", "label_risk": "Benign"}
{"id": "T1546.010_artifact_009", "input": "내부에서 사용하는 모니터링 툴이 GUI 애플리케이션들의 상태를 수집하기 위해 AppInit_DLLs 설정을 활용한다. 해당 DLL은 정식 코드 서명이 있으며, AppInit 구성이 들어 있는 시스템은 모두 관리 콘솔에 등록된 자산으로, 설치 스크립트와 변경 관리 티켓에도 이 설정이 명시되어 있다.", "label_tid": "T1546.010", "label_mid": "Persistence_AppInit_DLLs", "label_risk": "Benign"}
{"id": "T1546.010_artifact_010", "input": "시스템 튜닝 도구를 설치하면서, 공급사 가이드에 따라 특정 렌더링 관련 DLL이 AppInit_DLLs에 추가되었다. LoadAppInit_DLLs는 이미 켜져 있던 상태였고, RequireSignedAppInit_DLLs 역시 1로 설정되어 있어 서명된 DLL만 로드되는 구성이다. 비정상적인 프로세스 생성이나 파일 조작은 관찰되지 않는다.", "label_tid": "T1546.010", "label_mid": "Persistence_AppInit_DLLs", "label_risk": "Benign"}
{"id": "T1546.010_artifact_011", "input": "AppInit_DLLs에 등록된 DLL 경로가 C:\\Program Files\\<UNKNOWN>\\shim.dll로 되어 있는데, 이 벤더는 조직 내 승인 목록에 없다. 파일 자체는 정상적인 PE 구조를 가지지만 서명이 없고, 설치 로그도 일부만 남아 있어 새로 도입된 상용 제품인지 악성 모듈인지 판단이 애매한 상태다.", "label_tid": "T1546.010", "label_mid": "Persistence_AppInit_DLLs", "label_risk": "Suspicious"}
{"id": "T1546.010_artifact_012", "input": "레지스트리 감사를 통해 AppInit_DLLs 값이 여러 차례 수정된 기록이 있지만, 현재 하이브에는 마지막 상태만 남아 있어 과거에 어떤 DLL 경로들이 설정되었는지 알 수 없다. 현재 값은 정상 프로그램 설치 경로를 가리키고 있지만, 중간에 악성 DLL이 사용되었을 가능성을 완전히 배제하기 어렵다.", "label_tid": "T1546.010", "label_mid": "Persistence_AppInit_DLLs", "label_risk": "Suspicious"}
{"id": "T1546.010_artifact_013", "input": "LoadAppInit_DLLs는 1로 설정되어 있으나 AppInit_DLLs 값은 빈 문자열로 남아 있다. 과거에 특정 DLL이 등록되었다가 제거된 것인지, 단순히 미사용 상태인지는 로그 손실 때문에 명확히 확인되지 않는다. 악성 구성이 있었다면 이미 정리된 이후일 수 있다.", "label_tid": "T1546.010", "label_mid": "Persistence_AppInit_DLLs", "label_risk": "Suspicious"}
{"id": "T1546.010_artifact_014", "input": "RequireSignedAppInit_DLLs 값이 0으로 설정되어 있어 서명되지 않은 DLL도 AppInit 경로로 로드될 수 있는 상태지만, 현재 AppInit_DLLs에는 정상 제품 DLL만 지정되어 있다. 이 구성이 과거 악성 DLL을 로드하기 위해 사용되었는지, 단순히 벤더 요구 사항으로 설정된 것인지는 추가 정보 없이 판단하기 어렵다.", "label_tid": "T1546.010", "label_mid": "Persistence_AppInit_DLLs", "label_risk": "Suspicious"}
{"id": "T1546.010_artifact_015", "input": "사용자가 문제를 신고한 후 확인해 보니, AppInit_DLLs에 등록된 DLL이 존재하지 않는 경로를 가리키고 있었다. 이 경로에 과거 어떤 파일이 있었는지는 MFT 일부 손상으로 인해 불분명하다. 단순 잔여 설정일 가능성과, 이전에 악성 DLL이 존재했다가 삭제된 가능성이 모두 남아 있다.", "label_tid": "T1546.010", "label_mid": "Persistence_AppInit_DLLs", "label_risk": "Suspicious"}
{"id": "T1546.010_artifact_016", "input": "획득한 SOFTWARE 하이브에는 AppInit_DLLs, LoadAppInit_DLLs, RequireSignedAppInit_DLLs의 현재 값만 존재하고, 과거 값 변경 이력을 알 수 있는 트랜잭션 로그가 손상된 상태다. AppInit DLL 기반 지속성이 실제로 사용되었는지 평가하려면, 이전 시점의 SOFTWARE 백업, 레지스트리 감사 이벤트(예: 4657), 그리고 관련 DLL 파일들의 MFT 타임라인을 추가로 확보해야 한다.", "label_tid": "T1546.010", "label_mid": "Persistence_AppInit_DLLs", "label_risk": "Unknown"}
{"id": "T1546.010_artifact_017", "input": "시스템 복원 지점 이후의 디스크 이미지만 확보되어 있어, 복원 이전에 AppInit_DLLs 값에 어떤 DLL이 등록되어 있었는지 알 수 없다. AppInit 기반 하이재킹 여부를 확인하려면 복원 시점의 레지스트리 하이브 백업, 해당 기간의 설치·업데이트 이벤트 로그, 그리고 관련 GUI 프로세스 실행 타임라인이 추가로 필요하다.", "label_tid": "T1546.010", "label_mid": "Persistence_AppInit_DLLs", "label_risk": "Unknown"}
{"id": "T1546.010_artifact_018", "input": "레지스트리 정리 도구가 실행된 뒤라 AppInit 관련 키 일부가 최적화되었을 가능성이 있다. 현재 상태만으로는 과거에 악성 DLL이 AppInit_DLLs에 등록되었다가 제거되었는지 여부를 알 수 없다. 보다 정확한 판단을 위해, 도구 실행 전의 레지스트리 백업, USN Journal에서 AppInit 후보 경로의 생성·삭제 기록, 그리고 당시 Amcache/Prefetch 데이터를 추가 확인해야 한다.", "label_tid": "T1546.010", "label_mid": "Persistence_AppInit_DLLs", "label_risk": "Unknown"}
{"id": "T1546.010_artifact_019", "input": "획득한 아티팩트 세트에는 DLL 파일 자체가 포함되어 있지 않고, 텍스트 형태로 덤프된 레지스트리 정보만 존재한다. AppInit_DLLs에 어떤 경로가 설정되어 있었는지 단편적인 내용만으로는, 해당 DLL이 실제로 로드되어 악성 행위를 수행했는지 판단하기 어렵다. 원본 하이브, 디스크 이미지, 그리고 프로세스 생성 타임라인이 추가로 필요하다.", "label_tid": "T1546.010", "label_mid": "Persistence_AppInit_DLLs", "label_risk": "Unknown"}
{"id": "T1546.010_artifact_020", "input": "운영체제가 재설치된 뒤의 환경에서만 포렌식 수집이 이루어져, 이전 설치에서 AppInit_DLLs 구성이 어떻게 되어 있었는지 재구성할 수 없다. 과거에 AppInit DLL을 이용한 지속성이 있었는지 확인하려면 재설치 이전 디스크 이미지, 백업된 SOFTWARE 하이브, 그리고 옛 환경에서 수집된 타임라인(파일 시스템·Evtx)을 추가로 확보해야 한다.", "label_tid": "T1546.010", "label_mid": "Persistence_AppInit_DLLs", "label_risk": "Unknown"}
{"id": "T1547.004_artifact_001", "input": "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon 키의 Userinit 값에 원래 userinit.exe만 지정되어 있어야 하는데, 콤마로 구분된 두 번째 경로가 추가되어 있다. 이 추가 경로는 C:\\Users\\<USER>\\AppData\\Local 하위 비표준 폴더의 exe를 가리키며, 파일은 서명이 없고 최근에만 생성된 것으로 보인다. 사용자 로그온마다 이 exe에서 파생된 프로세스가 반복적으로 나타난다.", "label_tid": "T1547.004", "label_mid": "Persistence_Winlogon", "label_risk": "Malicious"}
{"id": "T1547.004_artifact_002", "input": "Winlogon Shell 값이 explorer.exe 대신 'explorer.exe, C:\\ProgramData\\<RANDOM>\\shellhost.exe'로 설정되어 있었다. shellhost.exe는 정상 설치 경로와 무관한 위치에 있고, MFT 타임라인 기준 사용자 로그온 시각마다 실행된 기록이 이어진다. 설치 로그나 프로그램 추가/제거 항목에는 이 파일을 사용하는 정식 소프트웨어가 없다.", "label_tid": "T1547.004", "label_mid": "Persistence_Winlogon", "label_risk": "Malicious"}
{"id": "T1547.004_artifact_003", "input": "HKCU\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon의 Shell 값이 기본값에서 변경되어 특정 스크립트를 wscript.exe로 실행하도록 설정되어 있었다. 스크립트 파일은 사용자 프로필의 Temp 폴더에 위치하고, 내용에는 추가 페이로드를 내려받는 코드가 포함되어 있다. 사용자 로그온 직후 이 스크립트가 실행되며 추가 exe가 생성되는 타임라인이 확인된다.", "label_tid": "T1547.004", "label_mid": "Persistence_Winlogon", "label_risk": "Malicious"}
{"id": "T1547.004_artifact_004", "input": "Winlogon 키의 Userinit 값이 system32\\userinit.exe가 아닌, ProgramData 하위 난수형 디렉터리의 exe로 완전히 치환되어 있었다. 이 exe는 로그인 프로세스 일부를 흉내 내면서 별도의 백그라운드 프로세스를 띄우고, 이후에도 사용자가 로그오프할 때까지 상주하는 패턴을 보인다.", "label_tid": "T1547.004", "label_mid": "Persistence_Winlogon", "label_risk": "Malicious"}
{"id": "T1547.004_artifact_005", "input": "수상한 시점 이후 Winlogon의 GinaDLL 관련 키에 더 이상 사용되지 않는 커스텀 DLL 경로가 설정되어 있었고, 해당 DLL은 서명이 없고 최근에만 생성되었다. 다양한 로그온 관련 프로세스에서 이 DLL을 로드한 흔적이 남아 있으며, 내부에는 추가 명령 실행 루틴이 포함되어 있다.", "label_tid": "T1547.004", "label_mid": "Persistence_Winlogon", "label_risk": "Malicious"}
{"id": "T1547.004_artifact_006", "input": "서드파티 보안 솔루션이 설치되면서 벤더 문서에 설명된 대로 Winlogon Notification 패키지용 레지스트리 키가 추가되었다. 관련 DLL은 C:\\Program Files\\<VENDOR>\\Security\\notify.dll에 위치하고, 유효한 코드 서명을 포함한다. 이벤트 로그와 제품 매뉴얼 모두 이 구성을 정상 동작으로 설명하고 있다.", "label_tid": "T1547.004", "label_mid": "Persistence_Winlogon", "label_risk": "Benign"}
{"id": "T1547.004_artifact_007", "input": "단말 관리 에이전트가 로그인 스크립트를 동작시키기 위해 Winlogon 키 일부를 사용하는 구성으로 배포되었다. 대상 경로는 Program Files 하위 정식 설치 디렉터리이며, 변경 관리 문서와 배포 스크립트에 동일한 값이 기록되어 있다. 해당 에이전트는 조직 표준 이미지에 포함된 구성 요소다.", "label_tid": "T1547.004", "label_mid": "Persistence_Winlogon", "label_risk": "Benign"}
{"id": "T1547.004_artifact_008", "input": "오래된 응용프로그램이 Windows 10에서 호환성을 맞추기 위해 설치 과정에서 Winlogon 키에 호환성 모듈을 등록한다. 이 값들은 제품 설치 디렉터리 내 DLL과 exe를 가리키며, 설치 로그와 공식 가이드에 명시된 설정과 일치한다. 추가 악성 행위는 관찰되지 않는다.", "label_tid": "T1547.004", "label_mid": "Persistence_Winlogon", "label_risk": "Benign"}
{"id": "T1547.004_artifact_009", "input": "사내 SSO 솔루션이 로그인 시 자격 증명을 처리하기 위해 Winlogon 관련 레지스트리를 사용하는 구조다. 해당 DLL과 exe는 모두 C:\\Program Files\\<VENDOR>\\SSO 경로에 있고, 정식 서명과 버전 정보가 포함되어 있다. 이벤트 로그에는 정상 인증 처리 이벤트만 나타나며, 다른 의심 정황은 없다.", "label_tid": "T1547.004", "label_mid": "Persistence_Winlogon", "label_risk": "Benign"}
{"id": "T1547.004_artifact_010", "input": "표준 빌드 스크립트가 처음 로그인 시 실행되는 초기화 도구를 Winlogon 영역에 등록하도록 설정되어 있다. 도구는 내부 자산 관리용 프로그램으로, 경로와 해시는 기준값과 일치하고, 실제 동작도 초기 설정 파일 배포에 국한된다.", "label_tid": "T1547.004", "label_mid": "Persistence_Winlogon", "label_risk": "Benign"}
{"id": "T1547.004_artifact_011", "input": "Winlogon Shell 값에 explorer.exe 이외에 추가적인 경로가 포함되어 있었지만, 현재는 그 경로에 파일이 존재하지 않는다. 과거에 어떤 파일이 있었는지 MFT 일부 손상으로 명확히 알 수 없으며, 단순 테스트 잔여물인지 악성 셸 교체 시도였는지 경계가 애매한 상태다.", "label_tid": "T1547.004", "label_mid": "Persistence_Winlogon", "label_risk": "Suspicious"}
{"id": "T1547.004_artifact_012", "input": "레지스트리 감사 이벤트에는 Winlogon Userinit 값이 한 번 변경되었다는 기록만 남아 있고, 이전 값과 새 값 모두 자세히 기록되어 있지 않다. 현재 값은 정상 userinit.exe만 포함하지만, 중간에 다른 경로가 사용되었는지 여부는 불분명하다.", "label_tid": "T1547.004", "label_mid": "Persistence_Winlogon", "label_risk": "Suspicious"}
{"id": "T1547.004_artifact_013", "input": "한 워크스테이션에서 Winlogon 관련 키를 편집한 흔적이 있으나, 변경 작업을 수행한 사용자가 누구인지와 구체적인 변경 내용을 보여주는 로그가 부족하다. 현재 설정 자체는 정상 범위로 보이지만, 일부 기간 동안 악성 값이 들어갔다가 제거되었을 가능성을 배제하기 어렵다.", "label_tid": "T1547.004", "label_mid": "Persistence_Winlogon", "label_risk": "Suspicious"}
{"id": "T1547.004_artifact_014", "input": "서드파티 소프트웨어 제거 후에도 Winlogon Notification 관련 레지스트리 키가 남아 있다. DLL 경로는 더 이상 존재하지 않는 폴더를 가리키며, 이 구성이 과거 악성 DLL로 교체되었다가 제거된 흔적인지 단순 잔여 구성인지는 현재 정보만으로는 판단하기 어렵다.", "label_tid": "T1547.004", "label_mid": "Persistence_Winlogon", "label_risk": "Suspicious"}
{"id": "T1547.004_artifact_015", "input": "사용자가 제기한 ‘로그인 후 화면이 잠시 검게 변한다’는 증상을 확인하는 과정에서 Winlogon 관련 키 일부가 기본값과 다르게 설정된 것이 발견되었다. 값이 가리키는 경로는 정식 설치 디렉터리지만, 이 변경이 성능 문제 해결 시도인지, 이전 악성 실험에서 남은 것인지 모호하다.", "label_tid": "T1547.004", "label_mid": "Persistence_Winlogon", "label_risk": "Suspicious"}
{"id": "T1547.004_artifact_016", "input": "획득한 SOFTWARE 및 SYSTEM 하이브에는 Winlogon 키의 현재 상태만 남아 있고, 과거 어떤 값이 설정되었는지에 대한 트랜잭션 로그는 손상된 상태다. Winlogon 기반 지속성이 실제로 사용되었는지 평가하려면, 이전 시점의 하이브 백업, 레지스트리 감사 이벤트(예: 4657), 그리고 사용자 로그온 시점의 MFT/Prefetch 타임라인을 추가로 확보해야 한다.", "label_tid": "T1547.004", "label_mid": "Persistence_Winlogon", "label_risk": "Unknown"}
{"id": "T1547.004_artifact_017", "input": "시스템 복원 기능이 여러 차례 수행된 후의 디스크 이미지만 확보되어 있어, 복원 이전에 Winlogon Shell이나 Userinit 값이 어떻게 설정되어 있었는지 알 수 없다. 과거에 악성 경로가 사용되었는지 확인하려면 복원 지점 생성 당시의 레지스트리 백업, 그 시기 로그인 관련 이벤트 로그, 그리고 관련 실행 파일의 Amcache 기록이 추가로 필요하다.", "label_tid": "T1547.004", "label_mid": "Persistence_Winlogon", "label_risk": "Unknown"}
{"id": "T1547.004_artifact_018", "input": "레지스트리 정리 도구 실행 이후 수집된 아티팩트라 Winlogon 관련 일부 하위 키가 최적화 과정에서 제거되었을 가능성이 있다. 현재 상태만으로는 과거에 악성 셸 교체나 Userinit 조작이 있었는지 판단하기 어렵다. 보다 정확한 분석을 위해 도구 실행 전의 레지스트리 백업, USN Journal에서 Winlogon 대상 경로의 생성·삭제 기록, 그리고 해당 기간의 로그인 타임라인을 추가 확인해야 한다.", "label_tid": "T1547.004", "label_mid": "Persistence_Winlogon", "label_risk": "Unknown"}
{"id": "T1547.004_artifact_019", "input": "수집된 증거에는 Winlogon 키의 텍스트 덤프만 포함되어 있고, 원본 하이브나 관련 DLL/EXE 파일은 포함되어 있지 않다. 현재 값이 정상으로 보인다고 해서 과거에 악성 값이 존재하지 않았다고 단정할 수 없다. Winlogon 기반 지속성을 확실히 부정하려면 전체 디스크 이미지, 레지스트리 백업, 그리고 오래된 로그인 세션에 대한 포렌식 타임라인이 추가로 필요하다.", "label_tid": "T1547.004", "label_mid": "Persistence_Winlogon", "label_risk": "Unknown"}
{"id": "T1547.004_artifact_020", "input": "운영체제가 재설치된 뒤의 환경에서만 포렌식 수집이 이루어져, 이전 설치에서 Winlogon 관련 설정이 어떻게 구성되어 있었는지 재구성할 수 없다. 과거에 Winlogon을 이용한 지속성이 있었는지 확인하려면 재설치 이전 디스크 이미지, 백업된 SYSTEM/SOFTWARE 하이브, 그리고 옛 환경에서 수집된 파일 시스템·Evtx 타임라인이 추가로 필요하다.", "label_tid": "T1547.004", "label_mid": "Persistence_Winlogon", "label_risk": "Unknown"}
{"id": "T1546.015_artifact_001", "input": "HKCU\\Software\\Classes\\CLSID\\{랜덤 GUID}\\InprocServer32 값이 원래 존재하지 않던 사용자 레지스트리에 새로 생성되었고, 기본값이 C:\\Users\\<USER>\\AppData\\Local\\Temp 하위 DLL을 가리킨다. 이 DLL은 서명이 없고 최근에만 생성되었으며, 해당 CLSID를 사용하는 Office 관련 프로세스에서 이 경로의 DLL이 반복적으로 로드된 흔적이 남아 있다.", "label_tid": "T1546.015", "label_mid": "Persistence_COM", "label_risk": "Malicious"}
{"id": "T1546.015_artifact_002", "input": "HKLM\\Software\\Classes\\CLSID\\{GUID}\\InprocServer32 의 기본 경로가 System32의 정식 DLL이 아니라 ProgramData 하위 난수형 디렉터리의 DLL로 변경되어 있었다. 변경 직후부터 여러 응용프로그램에서 이 비정상 DLL을 로드한 기록이 있으며, DLL 내부에는 추가 명령 실행 코드가 포함되어 있다.", "label_tid": "T1546.015", "label_mid": "Persistence_COM", "label_risk": "Malicious"}
{"id": "T1546.015_artifact_003", "input": "조사 시점 기준 특정 COM 인터페이스의 TreatAs 키가 설정되어, 원래 CLSID 대신 공격자가 만든 별도의 CLSID를 참조하고 있었다. 새 CLSID의 InprocServer32는 사용자 프로필 하위 비표준 경로의 DLL을 가리키며, 로그인 후 GUI 애플리케이션을 실행할 때마다 이 DLL이 로드된 흔적이 Evtx와 Amcache에 남아 있다.", "label_tid": "T1546.015", "label_mid": "Persistence_COM", "label_risk": "Malicious"}
{"id": "T1546.015_artifact_004", "input": "한 번도 설치된 적 없는 벤더 이름을 사용하는 COM 서버 등록 정보가 HKCU\\Software\\Classes\\CLSID 하위에 추가되어 있었다. 이 CLSID의 LocalServer32 값은 AppData\\Roaming 하위 exe를 지정하고 있으며, MFT 타임라인상 사용자가 특정 프로그램을 열 때마다 해당 exe가 함께 실행된 기록이 이어진다.", "label_tid": "T1546.015", "label_mid": "Persistence_COM", "label_risk": "Malicious"}
{"id": "T1546.015_artifact_005", "input": "Office 애플리케이션 시작 성능 문제를 조사하는 과정에서, 자주 사용되는 COM 컴포넌트의 InprocServer32가 정식 경로가 아닌 숨김 속성이 설정된 로컬 DLL을 가리키고 있음이 확인되었다. 이 DLL은 동일한 이름의 정식 DLL과 비교해 크기와 PE 섹션 구성이 다르며, 로드 직후 추가 악성 프로세스를 생성하는 코드가 포함되어 있다.", "label_tid": "T1546.015", "label_mid": "Persistence_COM", "label_risk": "Malicious"}
{"id": "T1546.015_artifact_006", "input": "정식 PDF 리더기를 설치한 직후, 벤더 문서에 명시된 대로 여러 COM CLSID가 HKLM\\Software\\Classes\\CLSID 하위에 등록되었다. InprocServer32 값은 모두 C:\\Program Files\\<VENDOR>\\Reader\\ 관련 DLL들을 가리키고 있으며, 파일 서명과 버전 정보도 공식 배포본과 일치한다. 특이한 프로세스 생성 패턴은 관찰되지 않는다.", "label_tid": "T1546.015", "label_mid": "Persistence_COM", "label_risk": "Benign"}
{"id": "T1546.015_artifact_007", "input": "기업용 백업 에이전트가 VSS 및 스냅샷 관련 기능을 위해 COM 서버를 등록하는 구조다. 관련 CLSID들은 공급사 가이드에 설명되어 있고, LocalServer32는 Program Files 하위 에이전트 실행 파일을 가리킨다. Evtx 이벤트와 제품 로그 모두 이를 정상 동작으로 기록하고 있다.", "label_tid": "T1546.015", "label_mid": "Persistence_COM", "label_risk": "Benign"}
{"id": "T1546.015_artifact_008", "input": "오피스 플러그인 설치 후 HKLM\\Software\\Classes\\CLSID와 HKCU\\Software\\Classes\\CLSID에 플러그인용 CLSID가 추가되었다. InprocServer32 경로는 모두 C:\\Program Files\\<VENDOR>\\Addins\\ 디렉터리를 가리키며, 코드 서명·버전 정보·설치 로그가 공급사 문서와 일치한다.", "label_tid": "T1546.015", "label_mid": "Persistence_COM", "label_risk": "Benign"}
{"id": "T1546.015_artifact_009", "input": "내부 개발팀이 만든 인하우스 자동화 도구가 Excel 및 Word와 연동하기 위해 COM 인터페이스를 등록한다. CLSID 키는 회사 이름으로 명시되어 있고, InprocServer32는 정식 배포 디렉터리 내 DLL을 가리키며, 소스 코드 저장소와 배포 문서에도 동일 CLSID와 경로가 기록되어 있다.", "label_tid": "T1546.015", "label_mid": "Persistence_COM", "label_risk": "Benign"}
{"id": "T1546.015_artifact_010", "input": "브라우저 확장 기능 관리 도구 설치 시, COM을 이용한 제어 인터페이스가 HKLM\\Software\\Classes에 등록되었다. InprocServer32는 서명된 DLL을 가리키고, 관련 이벤트 로그와 설정 파일에서도 같은 CLSID·경로 조합이 확인된다. 부작용이나 추가 악성 행위는 관찰되지 않는다.", "label_tid": "T1546.015", "label_mid": "Persistence_COM", "label_risk": "Benign"}
{"id": "T1546.015_artifact_011", "input": "HKCU\\Software\\Classes\\CLSID 하위에서, 제품 목록에 없는 벤더 이름으로 된 CLSID 한 개가 발견되었다. InprocServer32는 Program Files와 유사한 이름의 로컬 폴더 안 DLL을 가리키며, 이 DLL은 서명이 없고 설치 로그도 일부만 남아 있다. 새로 도입된 정상 툴인지, 위장된 악성 COM 서버인지 현재로서는 애매하다.", "label_tid": "T1546.015", "label_mid": "Persistence_COM", "label_risk": "Suspicious"}
{"id": "T1546.015_artifact_012", "input": "자주 사용되던 COM 인터페이스의 InprocServer32 경로가 한 번 바뀐 뒤 다시 원래 DLL로 되돌아간 정황이 레지스트리 감사 로그에만 남아 있다. 중간에 어떤 경로를 가리켰는지 상세 값은 기록되어 있지 않아, 단순 실수인지 일시적인 하이재킹 시도였는지 판단이 모호하다.", "label_tid": "T1546.015", "label_mid": "Persistence_COM", "label_risk": "Suspicious"}
{"id": "T1546.015_artifact_013", "input": "TreatAs 키가 설정된 CLSID 하나가 발견되었는데, 대상 CLSID는 현재 등록이 해제된 상태다. 과거에 어떤 DLL이 이 경로를 통해 로드되었는지는 MFT 일부 손상으로 명확히 확인되지 않는다. 단순 잔여 설정일 수도 있고, 이전 악성 COM 구성이 정리된 흔적일 수도 있다.", "label_tid": "T1546.015", "label_mid": "Persistence_COM", "label_risk": "Suspicious"}
{"id": "T1546.015_artifact_014", "input": "사용자가 인지하지 못한 사이 COM 서버 등록 정보 일부가 HKCU 영역에만 존재하는 것이 확인되었다. LocalServer32 경로는 정식 설치 폴더와 비슷해 보이지만, 해당 프로그램이 실제로 회사에서 승인된 것인지, 개인이 설치한 서드파티 도구인지 확실치 않다.", "label_tid": "T1546.015", "label_mid": "Persistence_COM", "label_risk": "Suspicious"}
{"id": "T1546.015_artifact_015", "input": "일부 응용프로그램이 실행될 때 COM 등록 오류 이벤트가 발생하며, 더 이상 존재하지 않는 CLSID를 참조한다는 경고가 남는다. 이 CLSID가 과거에 악성 DLL을 가리켰다가 제거된 것인지, 단순히 오래된 설정이 남아 있는 것인지 추가 정보 없이 구분하기 어렵다.", "label_tid": "T1546.015", "label_mid": "Persistence_COM", "label_risk": "Suspicious"}
{"id": "T1546.015_artifact_016", "input": "획득한 SOFTWARE 하이브에는 COM 관련 CLSID 키들이 현재 상태로만 남아 있고, 과거 값 변화를 보여주는 트랜잭션 로그는 손상된 상태다. COM 하이재킹 기반 지속성이 실제로 사용되었는지 평가하려면 이전 시점의 레지스트리 백업, 레지스트리 감사 이벤트(예: 4657), 그리고 대상 DLL/EXE 경로의 MFT 타임라인을 추가로 확보해야 한다.", "label_tid": "T1546.015", "label_mid": "Persistence_COM", "label_risk": "Unknown"}
{"id": "T1546.015_artifact_017", "input": "시스템 복원 기능이 여러 차례 수행된 뒤의 디스크 이미지만 확보되어 있어, 복원 이전에 어떤 CLSID가 존재했는지, InprocServer32나 LocalServer32가 어떤 파일을 가리켰는지 알 수 없다. 과거 COM 기반 지속성 여부를 확인하려면 복원 지점 생성 당시의 SOFTWARE 하이브, 설치·제거 이벤트 로그, 그리고 해당 시기 프로그램 실행 타임라인이 추가로 필요하다.", "label_tid": "T1546.015", "label_mid": "Persistence_COM", "label_risk": "Unknown"}
{"id": "T1546.015_artifact_018", "input": "레지스트리 정리 도구를 돌린 이후 수집된 아티팩트라, 사용되지 않는 COM 등록 정보 상당수가 제거된 상태다. 정리 이전에 악성 CLSID가 존재했는지, InprocServer32가 비정상 DLL을 가리킨 적이 있었는지 현재 정보만으로는 알 수 없다. 판단을 위해 도구 실행 전 백업, USN Journal에서 DLL 경로 생성·삭제 기록, 그리고 Amcache/Prefetch 데이터를 추가 확보해야 한다.", "label_tid": "T1546.015", "label_mid": "Persistence_COM", "label_risk": "Unknown"}
{"id": "T1546.015_artifact_019", "input": "수집된 자료에는 텍스트 형태의 CLSID 목록만 존재하고, 실제 DLL/EXE 파일이나 원본 하이브는 포함되어 있지 않다. 나열된 CLSID들이 모두 정상인지, 일부가 악성 COM 서버였는지 로그만으로는 판별하기 어렵다. 보다 정확한 분석을 위해 전체 디스크 이미지, 레지스트리 백업, 그리고 해당 기간의 프로세스 생성 타임라인이 필요하다.", "label_tid": "T1546.015", "label_mid": "Persistence_COM", "label_risk": "Unknown"}
{"id": "T1546.015_artifact_020", "input": "운영체제가 재설치된 뒤의 환경에서만 포렌식 수집이 이루어져, 이전 설치에서 COM 등록 정보가 어떻게 구성되어 있었는지 재구성할 수 없다. 과거에 COM 하이재킹 기반 지속성이 사용되었는지 확인하려면 재설치 이전 디스크 이미지, 백업된 SOFTWARE 하이브, 그리고 옛 환경에서 수집된 파일 시스템·Evtx 타임라인을 추가로 확보해야 한다.", "label_tid": "T1546.015", "label_mid": "Persistence_COM", "label_risk": "Unknown"}
