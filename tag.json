[
  {
    "category": "System",
    "subcategory": "OS_Info",
    "description": "운영체제 버전, 빌드, 설치 정보 및 등록자 정보를 확인한다.",
    "keywords": [
      "Microsoft\\Windows NT\\CurrentVersion AND ProductName",
      "Microsoft\\Windows NT\\CurrentVersion AND EditionID",
      "Microsoft\\Windows NT\\CurrentVersion AND BuildLabEx",
      "Microsoft\\Windows NT\\CurrentVersion AND InstallDate",
      "Microsoft\\Windows NT\\CurrentVersion AND RegisteredOwner",
      "Microsoft\\Windows NT\\CurrentVersion AND ProductId"
    ]
    },
    {
      "category": "System",
      "subcategory": "User_Info",
      "description": "시스템의 사용자 프로필 경로 및 최근 로그인 계정을 식별한다.",
      "keywords": [
        "Microsoft\\Windows NT\\CurrentVersion\\ProfileList AND ProfileImagePath",
        "Microsoft\\Windows NT\\CurrentVersion\\ProfileList AND ProfilesDirectory",
        "Microsoft\\Windows NT\\CurrentVersion\\ProfileList AND Default",
        "Microsoft\\Windows NT\\CurrentVersion\\ProfileList AND Public",
        "Microsoft\\Windows NT\\CurrentVersion\\ProfileList AND ProgramData",
        "Microsoft\\Windows\\CurrentVersion\\Authentication\\LogonUI AND LastLoggedOnUser",
        "Microsoft\\Windows\\CurrentVersion\\Authentication\\LogonUI AND LastLoggedOnDisplayName",
        "Microsoft\\Windows\\CurrentVersion\\Authentication\\LogonUI AND LastLoggedOnUserSID",
        "Microsoft\\Windows\\CurrentVersion\\Authentication\\LogonUI AND SelectedUserSID"
      ]
    },
    {
    "category": "System",
    "subcategory": "Boot_Records",
    "description": "시스템 부팅, 종료, 비정상 종료 이벤트를 식별하여 시스템 가동 이력과 장애 여부를 확인한다.",
    "keywords": [],
    "event_id": [6005, 6006, 6008]
    },
    {
      "category": "System",
      "subcategory": "Computer_Name_Change",
      "description": "컴퓨터 이름 변경 이벤트를 탐지하여 식별 위장 시도를 확인한다.",
      "keywords": [],
      "event_id": [6011]
    },
    {
    "category": "System",
    "subcategory": "System_Drivers",
    "description": "드라이버 설치 및 로드 이력을 확인하여 시스템 커널 변경을 추적한다.",
    "keywords": [
      "CurrentControlSet\\Services AND Type=0x1 OR Type=0x2",
      "EventLogProvider=Microsoft-Windows-Kernel-PnP",
      "EventSource=Kernel-PnP"
    ],
    "event_id": [6]
    },
    {
    "category": "System",
    "subcategory": "Network_Interfaces",
    "description": "디스크 상의 SYSTEM 및 SOFTWARE 하이브를 분석하여 네트워크 어댑터의 설치 정보, IP 구성, MAC 주소를 복원한다.",
    "keywords": [
      "ControlSet001\\Services\\Tcpip\\Parameters\\Interfaces",
      "ControlSet001\\Control\\Class\\{4d36e972-e325-11ce-bfc1-08002be10318}",
      "Microsoft\\Windows NT\\CurrentVersion\\NetworkCards"
    ]
    },

    {
    "category": "System",
    "subcategory": "Volume_Info",
    "description": "드라이브 볼륨 정보, 마운트 이력, 시리얼 번호를 수집한다.",
    "keywords": ["mountvol", "Volume Serial Number", "Logical Volume ID"],
    "exclude_patterns": [
      "WofCompressedData",
      "Windows\\assembly\\NativeImages",
      "WinSxS"
    ],
    "event_id": [98]
  } ,{
    "category": "System",
    "subcategory": "USB_Connection_History",
    "description": "시스템에 연결된 USB 저장장치의 연결·해제 기록을 확인하여 외부 매체 사용 여부를 파악한다.",
    "keywords": [
      "CurrentControlSet\\Enum\\USBSTOR",
      "Microsoft\\Windows\\CurrentVersion\\Explorer\\MountPoints2"
      
    ],
    "event_id": [2003, 2100, 2102]
  },
    {
      "category": "System",
      "subcategory": "Eventlog_Cleared",
      "description": "시스템/보안 로그가 초기화 또는 삭제된 흔적을 확인한다.",
      "keywords": ["Event Log cleared", "wevtutil cl", "Clear-EventLog"],
      "event_id": [1102]
    },
    



  {
    "category": "System",
    "subcategory": "TimeZone_Config",
    "description": "시스템 시간대 및 일광절약 설정을 확인하여 로그 타임라인의 신뢰성을 확보한다.",
    "keywords": [
      "CurrentControlSet\\Control\\TimeZoneInformation AND TimeZoneKeyName",
      "CurrentControlSet\\Control\\TimeZoneInformation AND Bias",
      "CurrentControlSet\\Control\\TimeZoneInformation AND ActiveTimeBias",
      "CurrentControlSet\\Control\\TimeZoneInformation AND DaylightBias",
      "CurrentControlSet\\Control\\TimeZoneInformation AND StandardBias",
      "CurrentControlSet\\Control\\TimeZoneInformation AND DynamicDaylightTimeDisabled"
    ]
  },

  
  {
    "category": "System",
    "subcategory": "Hardware_Info",
    "description": "CPU, 메모리, 디스크, BIOS 등 하드웨어 구성 정보를 확인하여 시스템의 물리적 환경을 파악한다.",
    "keywords": [
      "HARDWARE\\DESCRIPTION\\System\\CentralProcessor\\0 AND Identifier",
      "HARDWARE\\DESCRIPTION\\System\\CentralProcessor\\0 AND ProcessorNameString",
      "HARDWARE\\DESCRIPTION\\System\\CentralProcessor\\0 AND ~MHz",
      "HARDWARE\\DESCRIPTION\\System\\BIOS AND SystemManufacturer",
      "HARDWARE\\DESCRIPTION\\System\\BIOS AND SystemProductName",
      "HARDWARE\\DESCRIPTION\\System\\BIOS AND BIOSVersion",
      "HARDWARE\\DESCRIPTION\\System\\BIOS AND BIOSReleaseDate",
      "SYSTEM\\CurrentControlSet\\Control\\SystemInformation AND SystemManufacturer",
      "SYSTEM\\CurrentControlSet\\Control\\SystemInformation AND SystemProductName"
    ],
    "event_id": [12]
  },
  {
    "category": "System",
    "subcategory": "System_Integrity_Check",
    "description": "CBS.log 내 주요 키워드를 분석하여 시스템 파일 손상, 복구 여부, 무결성 위반 시점을 식별한다.",
    "keywords": [
      "C:\\Windows\\Logs\\CBS\\CBS.log AND [SR]",
      "C:\\Windows\\Logs\\CBS\\CBS.log AND Repairing corrupted file",
      "C:\\Windows\\Logs\\CBS\\CBS.log AND Cannot repair member file",
      "C:\\Windows\\Logs\\CBS\\CBS.log AND Corrupt",
      "C:\\Windows\\Logs\\CBS\\CBS.log AND corruption",
      "C:\\Windows\\Logs\\CBS\\CBS.log AND Repaired file",
      "C:\\Windows\\Logs\\CBS\\CBS.log AND Fixed file",
      "C:\\Windows\\Logs\\CBS\\CBS.log AND Verify and Repair transaction completed",
      "C:\\Windows\\Logs\\CBS\\CBS.log AND Error",
      "C:\\Windows\\Logs\\CBS\\CBS.log AND Failure",
      "C:\\Windows\\Logs\\CBS\\CBS.log AND CSI"
    ],
    "event_id": [1001, 1002, 1003]
  },

  {
    "category": "System",
    "subcategory": "Security_Status",
    "description": "Windows Defender와 방화벽의 활성화 상태를 확인하여 공격 당시 시스템 방어 기능의 작동 여부를 판단한다.",
    "keywords": [
      "Microsoft\\Windows Defender",
      "CurrentControlSet\\Services\\mpssvc",
      "CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy"
    ],
    "EventId": [5007]
  },
  {
    "category": "System",
    "subcategory": "Storage_Device_Info",
    "description": "로컬 및 외장 저장장치의 볼륨 정보와 USB 연결 이력을 통합 수집하여 외부 매체 사용 여부와 연결 시점을 분석한다.",
    "keywords": [
      "\\MountedDevices",
      "CurrentControlSet\\Enum\\USBSTOR",
      "CurrentControlSet\\Enum\\USB",
      "Microsoft\\Windows\\CurrentVersion\\Explorer\\MountPoints2"
    ],
    "event_id": [98, 2003, 2100, 2102]
  },
{
  "category": "System",
  "subcategory": "User_Account_Activity",
  "description": "사용자 계정 생성, 비활성화, 암호 변경, 그룹 권한 변경 등의 계정 관리 활동을 추적한다.",
  "keywords": [],
  "event_id": [4720, 4722, 4723, 4724, 4725, 4728, 4732, 4740, 4767]
},




{
    "category": "Persistence",
    "subcategory": "DLL_AppPaths_PathExtension",
    "description": "App Paths의 Path 값을 이용해 검색 경로를 확장한다.",
    "keywords": [
      "HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\App Paths\\*.exe\\Path",
      "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\App Paths\\*.exe\\Path",
      "App Paths",
      "PATH extension"
    ]
  },
  {
    "category": "Persistence",
    "subcategory": "DLL_KnownDLLs_Hijacking",
    "description": "KnownDLLs 구성을 악용해 시스템 DLL 로드를 가로챈다.",
    "keywords": [
      "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\KnownDLLs",
      "KnownDLLs",
      "KnownDlls override",
      "System32\\*.dll"
    ]
  },
  {
    "category": "Persistence",
    "subcategory": "DLL_SearchOrder_Hijacking",
    "description": "DLL 검색 순서를 악용해 먼저 로드되도록 유도한다.",
    "keywords": [
      "Current Working Directory",
      "C:\\AppData\\Roaming\\**\\*.dll",
      "C:\\ProgramData\\*.dll",
      "side-loading",
      "preload",
      "untrusted search path"
    ]
  },
  {
    "category": "Persistence",
    "subcategory": "DLL_SideLoading_AppDir",
    "description": "서명된 실행 파일 디렉터리에 악성 DLL을 배치해 로드되게 한다.",
    "keywords": [
      "C:\\ProgramData\\*\\App\\*.dll",
      "binary side-loading",
      "app directory dll"
    ]
  },
  {
    "category": "Persistence",
    "subcategory": "DLL_SxS_Manifest_Hijacking",
    "description": "SxS 매니페스트를 조작해 DLL 경로를 재지정한다.",
    "keywords": [
      "C:\\Windows\\WinSxS\\*\\.*dll",
      "*.manifest",
      "dependentAssembly",
      "assemblyIdentity",
      "appname.exe.local"
    ]
  },
  {
    "category": "Persistence",
    "subcategory": "Run_HKCU",
    "description": "HKCU Run 키로 사용자 로그인 시 자동 실행되도록 등록한다.",
    "keywords": [
    "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run",
    "AppData\\Local\\**\\*.exe",
    "autorun",
    "registry persistence"
    ]
  },
  {
    "category": "Persistence",
    "subcategory": "Run_HKLM",
    "description": "HKLM Run 키로 모든 사용자 로그인 시 자동 실행되도록 등록한다.",
    "keywords": [
    "HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run",
    "C:\\ProgramData\\**\\*.exe",
    "autorun all users"
    ]
  },
  {
    "category": "Persistence",
    "subcategory": "Run_HKCU_Wow6432Node",
    "description": "HKCU Wow6432Node Run 키를 이용해 32비트 컨텍스트로 실행되도록 등록한다.",
    "keywords": [
      "HKCU\\Software\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Run",
      "AppData\\Local\\**\\*.exe",
      "run 32-bit"
    ]
  },
  {
    "category": "Persistence",
    "subcategory": "Run_HKLM_Wow6432Node",
    "description": "HKLM Wow6432Node Run 키를 이용해 시스템 전역 32비트 실행을 등록한다.",
    "keywords": [
      "HKLM\\Software\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Run",
      "C:\\ProgramData\\**\\*.exe",
      "run 32-bit global"
    ]
  },
  {
    "category": "Persistence",
    "subcategory": "RunOnce_HKCU",
    "description": "HKCU RunOnce 키로 다음 로그인에서 1회 실행되도록 등록한다.",
    "keywords": [
      "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce",
      "RegExpandSz",
      "\\AppData\\Roaming\\**\\*.exe",
      "one-time run"
    ]
  },
  {
    "category": "Persistence",
    "subcategory": "RunOnce_HKLM",
    "description": "HKLM RunOnce 키로 시스템 전역 1회 실행을 등록한다.",
    "keywords": [
      "HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce",
      "C:\\ProgramData\\**\\*.exe",
      "one-time run all users"
    ]
  },
  {
    "category": "Persistence",
    "subcategory": "RunServices_HKLM",
    "description": "RunServices 키로 로그인 시 서비스형 실행을 유발한다.",
    "keywords": [
      "HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServices",
      "HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServicesOnce",
      "service-style autorun"
    ]
  },
  {
    "category": "Persistence",
    "subcategory": "User_Run_Policy_HKCU",
    "description": "정책 기반 Run 키로 사용자별 시작 프로그램을 강제한다.",
    "keywords": [
      "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run",
      "\\AppData\\Roaming\\**\\*.exe",
      "policy run"
    ]
  },
  {
    "category": "Persistence",
    "subcategory": "Startup_Folder_User",
    "description": "사용자 Startup 폴더에 LNK/EXE를 배치해 자동 실행되도록 한다.",
    "keywords": [
      "AppData\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\*.lnk",
      "AppData\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\*.exe",
      "shell:startup",
      "explorer.exe"
    ]
  },
  {
    "category": "Persistence",
    "subcategory": "Startup_Folder_Common",
    "description": "공용 Startup 폴더에 항목을 배치해 모든 사용자에게 자동 실행되도록 한다.",
    "keywords": [
      "ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\*.lnk",
      "ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\*.exe",
      "shell:common startup"
    ]
  },

 {
    "category": ["useractivity", "metadata"], 
    "subcategory": "Recent_Documents",
    "description": "사용자가 최근에 접근하거나 실행한 파일의 흔적을 나타낸다.",
    "keywords": ["RecentDocs", ".lnk", "Recent Documents", "Recent Items"],
    "event_id": []
  },



  
  
  {
    "category": "Exfiltration",
    "subcategory": "Archive_Files_Detection",
    "description": "사용자가 생성하거나 접근한 ZIP·RAR·7Z 파일 흔적을 탐지한다. 시스템 자동 압축(WOF, NativeImages, WinSxS)은 제외한다.",
    "keywords": [".zip", ".rar", ".7z"],
    "exclude_patterns": ["WofCompressedData", "\\\\Windows\\\\assembly\\\\NativeImages", "WinSxS"],
    "event_id": [4663, 4656]
  },
  {
    "category": "Exfiltration",
    "subcategory": "Large_File_Creation",
    "description": "50MB 이상의 대형 파일이 짧은 시간 내 생성된 흔적을 탐지한다. AppData나 Temp 위치일 경우 유출 준비 가능성이 있다.",
    "keywords": ["FileSize:>52428800", "Path:(AppData|Temp|Downloads)"],
    "exclude_patterns": ["pagefile.sys", "hiberfil.sys"],
    "event_id": [4663]
  },
  {
    "category": "Exfiltration",
    "subcategory": "Temp_Dir_Abuse",
    "description": "임시 폴더(%TEMP%)에 대형·암호화된 파일이 다량 생성된 경우 업로드 전 임시 저장 가능성이 있다.",
    "keywords": ["%TEMP%", "FileNameRegex:^(tmp|~)[a-z0-9]{6,}", "Entropy:>7.5"],
    "exclude_patterns": ["setup", "install", "update"],
    "event_id": [4663, 4656]
  },
  {
    "category": "Exfiltration",
    "subcategory": "USB_File_Transfer",
    "description": "외장 저장장치(USB 등)에 파일이 복사·이동된 흔적을 탐지한다.",
    "keywords": [
      "ShellBagPath:.*(Removable|USB).*",
      "Registry:MountPoints2",
      "Path:\\\\Users\\\\.* AND DriveType:Removable"
    ],
    "exclude_patterns": ["Virtual", "Hyper-V", "Loopback"],
    "event_id": [4663, 4656, 1102]
  },
  {
    "category": "Exfiltration",
    "subcategory": "Cloud_Sync_Folders",
    "description": "OneDrive, Dropbox, GoogleDrive 폴더 내 압축·대용량 파일 생성 흔적을 탐지한다.",
    "keywords": [
      "Path:.*\\\\OneDrive\\\\.*",
      "Path:.*\\\\Dropbox\\\\.*",
      "Path:.*\\\\GoogleDrive\\\\.*",
      "FileName:(*.zip OR *.7z OR *.rar)"
    ],
    "exclude_patterns": ["SyncConfig", "snapshot.db"],
    "event_id": [600, 4104]
  },
  {
    "category": "Exfiltration",
    "subcategory": "Prefetch_Transfer_Tools",
    "description": "유출에 자주 사용되는 도구(robocopy, certutil, curl, powershell 등)의 실행 흔적을 탐지한다.",
    "keywords": [
      "ROBOCOPY.EXE-*.pf",
      "CERTUTIL.EXE-*.pf",
      "CURL.EXE-*.pf",
      "POWERSHELL.EXE-*.pf",
      "BITSADMIN.EXE-*.pf"
    ],
    "exclude_patterns": ["WindowsUpdate", "Defender"],
    "event_id": [4104, 4688]
  },
  {
    "category": "Exfiltration",
    "subcategory": "Hidden_Payloads",
    "description": "이중 확장자(report.pdf.exe) 또는 난독화된 임시파일명을 탐지하여 위장된 유출 파일을 식별한다.",
    "keywords": [
      "FileNameRegex:^.*\\.(pdf|docx)\\.exe$",
      "FileNameRegex:^~?tmp[a-z0-9]{6,}\\.[a-z0-9]{2,4}$",
      "Entropy:>7.0"
    ],
    "exclude_patterns": ["installer", "setup"],
    "event_id": [4688]
  },
  {
    "category": "Exfiltration",
    "subcategory": "Browser_Uploads",
    "description": "브라우저 기록에서 업로드 관련 URL(file.io, drive.google.com 등)을 탐지한다.",
    "keywords": [
      "URL:(upload|file.io|anonfiles|mega|drive.google.com|dropbox.com)",
      "DownloadPath:.*\\\\Downloads\\\\.*\\.(zip|7z|rar)"
    ],
    "exclude_patterns": ["microsoft.com", "update"],
    "event_id": [4104]
  },
  {
    "category": "Exfiltration",
    "subcategory": "LNK_JumpList_Artifacts",
    "description": "LNK 및 점프리스트에서 외부 장치나 클라우드 경로를 가리키는 항목을 식별한다.",
    "keywords": [
      "LNK:TargetPath:.*\\\\(Removable|OneDrive|Dropbox)\\\\.*",
      "JumpList:automaticDestinations-ms",
      "RecentItems:*.lnk AND TargetUrl:*.zip"
    ],
    "exclude_patterns": ["Desktop", "Documents"],
    "event_id": []
  },
  {
    "category": "Exfiltration",
    "subcategory": "Sensitive_File_Access",
    "description": "민감 확장자(.key, .wallet, .pem, .db 등)에 대한 접근·복사 이벤트를 탐지한다.",
    "keywords": [
      "FileNameRegex:.*\\.(key|pem|pfx|wallet|db|sqlite)$",
      "Path:(AppData|Roaming|Documents)"
    ],
    "exclude_patterns": ["system32", "drivers"],
    "event_id": [4663]
  },
  {
    "category": "Exfiltration",
    "subcategory": "Forensic_Artifacts_Deletion",
    "description": "이벤트 로그, Prefetch, MFT 등 포렌식 로그 삭제·초기화 흔적을 탐지한다.",
    "keywords": [
      "FileName:*.evtx AND Size:0",
      "$LogFile Deleted",
      "RecycleBin:DeleteAll"
    ],
    "exclude_patterns": ["WindowsUpdate.log"],
    "event_id": [1102]
  },
  {
    "category": "Exfiltration",
    "subcategory": "Encrypted_Containers",
    "description": "VeraCrypt, BitLocker, TrueCrypt 등의 암호화 컨테이너 생성 흔적을 탐지한다.",
    "keywords": [
      "FileName:(*.tc OR *.hc OR *.vhdx)",
      "Path:Users\\\\.*\\\\Documents",
      "Prefetch:(veracrypt.exe OR truecrypt.exe)"
    ],
    "exclude_patterns": ["System Volume Information"],
    "event_id": [5380, 851]
  },
  {
    "category": "Exfiltration",
    "subcategory": "Screenshot_Archives",
    "description": "다수의 스크린샷 파일과 함께 압축파일이 존재할 경우 스크린 캡처 유출 가능성을 탐지한다.",
    "keywords": [
      "FileNameRegex:.*(screenshot|capture).*\\.(jpg|png)$",
      "FileName:*screenshots*.zip"
    ],
    "exclude_patterns": ["Wallpaper", "Background"],
    "event_id": [4663]
  }




]
