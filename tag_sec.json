[
  {
    "category": "Security",
    "subcategory": "Defender_Config_Change",
    "description": "Windows Defender/Defender ATP(감시 대상) 설정 변경, 예외 추가, 실시간 검사 비활성화, MP cmdlet 사용 흔적을 탐지한다.",
    "keywords": [
      "SOFTWARE\\Microsoft\\Windows Defender\\Policy Manager AND DisableRealtimeMonitoring",
      "SOFTWARE\\Microsoft\\Windows Defender\\Exclusions",
      "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender",
      "powershell.exe Set-MpPreference",
      "powershell.exe Add-MpPreference -ExclusionPath",
      "MpCmdRun.exe",
      "DisableAntiSpyware",
      "Windows Defender Tamper Protection",
      "AMSI SCANNING_DISABLE OR Disable-AntimalwareScanning"
    ]
  },
  {
    "category": "Security",
    "subcategory": "Firewall_Rule_Modification",
    "description": "Windows 방화벽 규칙의 추가/수정/삭제 및 netsh/PowerShell을 통한 변경 흔적을 확인한다.",
    "keywords": [
      "EventID:2004 AND Source:Microsoft-Windows-Windows Firewall",
      "EventID:4946 OR 4947 OR 4948 OR 4950",
      "netsh advfirewall firewall",
      "HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy",
      "New-NetFirewallRule",
      "Remove-NetFirewallRule",
      "Windows Defender Firewall Diagnostics"
    ]
  },
  {
    "category": "Security",
    "subcategory": "UAC_Bypass",
    "description": "UAC 우회 기법(정상 바이너리 오용, registry hijack, auto-elevate) 관련 흔적 탐지.",
    "keywords": [
      "fodhelper.exe",
      "sdclt.exe",
      "EventID:4688 AND CommandLine CONTAINS 'eventvwr.exe'",
      "HKCU\\Software\\Classes\\mscfile\\shell\\open\\command",
      "HKCU\\Software\\Classes\\ms-settings\\Shell\\Open\\command",
      "HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options",
      "ConsentPromptBehaviorAdmin",
      "EnableLUA",
      "sdclt.exe /kickoffelev"
    ]
  },
  {
    "category": "Security",
    "subcategory": "GroupPolicy_Modification",
    "description": "로컬/도메인 그룹 정책 파일 및 registry.pol 변경, gpupdate 강제 적용 흔적을 탐지한다.",
    "keywords": [
      "C:\\Windows\\System32\\GroupPolicy",
      "Registry.pol",
      "EventID:4739 OR 4719",
      "gpupdate /force",
      "gpt.ini",
      "EventID:1704 AND Source:Security-SPP",
      "PolicyDefinitions",
      "Machine\\SOFTWARE\\Policies\\"
    ]
  },
  {
    "category": "Security",
    "subcategory": "AV_Process_Kill",
    "description": "안티바이러스/EDR 프로세스 강제종료 및 서비스 중지 시도/성공 기록을 탐지한다.",
    "keywords": [
      "taskkill /F /IM MsMpEng.exe",
      "ProcessTermination AND MsMpEng.exe",
      "EventID:4688 AND CommandLine CONTAINS 'ProcessHacker'",
      "sc stop windefend",
      "EventID:7036 AND ServiceName CONTAINS 'Windows Defender'",
      "EventID:7035 OR 7040 OR 7036 (Service control manager)",
      "EventID:4689 (Process ended)",
      "EventID:4690 (Attempt to duplicate a handle?)",
      "TerminateProcess"
    ]
  },
  {
    "category": "Security",
    "subcategory": "Security_Log_Clear",
    "description": "Security 이벤트 로그의 삭제/초기화 및 로그 접근 조작 흔적을 탐지한다.",
    "keywords": [
      "EventID:1102 AND Source:Microsoft-Windows-Eventlog",
      "wevtutil cl Security",
      "EventID:104 AND Source:Eventlog",
      "EventID:1100",
      "Security.evtx LastWriteTime anomaly",
      "EventID:517",
      "AuditPolicy change",
      "SeShutdownPrivilege usage"
    ]
  },

  {
    "category": "Security",
    "subcategory": "ScheduledTask_Modification",
    "description": "스케줄드 태스크(작업 스케줄러)를 통한 우회/유지·변경 흔적을 탐지한다 — 자주 persistence/우회에 사용됨.",
    "keywords": [
      "SCHTASKS /Create",
      "C:\\Windows\\System32\\Tasks",
      "EventID:4698 OR 4699 OR 4700 OR 4701 (Task created/changed/deleted)",
      "schtasks.exe /delete",
      "Task XML LastModified",
      "schtasks /Change",
      "Autorun via Scheduled Task"
    ]
  },
  {
    "category": "Security",
    "subcategory": "Audit_Policy_Change",
    "description": "감사(Audit) 정책 변경으로 로깅을 약화시키려는 시도 탐지 — 탐지 우회 핵심 흔적.",
    "keywords": [
      "Auditpol.exe /set",
      "EventID:4719 (System audit policy was changed)",
      "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Audit",
      "Advanced Audit Policy configuration",
      "SACL changes",
      "Local Security Policy changes"
    ]
  },
  {
    "category": "Security",
    "subcategory": "PowerShell_Logging_Disable_and_Obfuscation",
    "description": "PowerShell 로그/스크립트블록/모듈 로그 비활성화, 난독화된 커맨드 사용 및 파일 흔적을 탐지한다.",
    "keywords": [
      "EventID:4104 (PowerShell ScriptBlock)",
      "EventID:4103 (PowerShell pipeline)","EventID:4688 AND CommandLine CONTAINS 'powershell.exe -enc'",
      "HKLM\\Software\\Policies\\Microsoft\\Windows\\PowerShell",
      "DisableScriptBlockLogging",
      "DisableModuleLogging",
      "EncodedCommand",
      "Base64 -enc"
    ]
  },
  {
    "category": "Security",
    "subcategory": "Tamper_Protection_Disable",
    "description": "EDR/Defender Tamper Protection 비활성화 및 관련 MDM/Policy 변경 흔적을 탐지한다.",
    "keywords": [
      "Tamper Protection",
      "HKLM\\SOFTWARE\\Microsoft\\Windows Defender\\Features",
      "DisableTamperProtection",
      "MDM policy changes",
      "Intune device configuration",
      "Windows Security Center service status changes"
    ]
  }
]
