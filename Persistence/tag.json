[
  {
    "category": "Persistence",
    "subcategory": "DLL_AppPaths_PathExtension",
    "description": "App Paths의 Path 값을 이용해 검색 경로를 확장한다.",
    "keywords": [
      "HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\App Paths\\*.exe\\Path",
      "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\App Paths\\*.exe\\Path",
      "App Paths",
      "PATH extension"
    ]
  },
  {
    "category": "Persistence",
    "subcategory": "DLL_KnownDLLs_Hijacking",
    "description": "KnownDLLs 구성을 악용해 시스템 DLL 로드를 가로챈다.",
    "keywords": [
      "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\KnownDLLs",
      "KnownDLLs",
      "KnownDlls override",
      "System32\\*.dll"
    ]
  },
  {
    "category": "Persistence",
    "subcategory": "DLL_SearchOrder_Hijacking",
    "description": "DLL 검색 순서를 악용해 먼저 로드되도록 유도한다.",
    "keywords": [
      "Current Working Directory",
      "C:\\AppData\\Roaming\\**\\*.dll",
      "C:\\ProgramData\\*.dll",
      "side-loading",
      "preload",
      "untrusted search path"
    ]
  },
  {
    "category": "Persistence",
    "subcategory": "DLL_SideLoading_AppDir",
    "description": "서명된 실행 파일 디렉터리에 악성 DLL을 배치해 로드되게 한다.",
    "keywords": [
      "C:\\ProgramData\\*\\App\\*.dll",
      "binary side-loading",
      "app directory dll"
    ]
  },
  {
    "category": "Persistence",
    "subcategory": "DLL_SxS_Manifest_Hijacking",
    "description": "SxS 매니페스트를 조작해 DLL 경로를 재지정한다.",
    "keywords": [
      "C:\\Windows\\WinSxS\\*\\.*dll",
      "*.manifest",
      "dependentAssembly",
      "assemblyIdentity",
      "appname.exe.local"
    ]
  },
  {
    "category": "Persistence",
    "subcategory": "Run_HKCU",
    "description": "HKCU Run 키로 사용자 로그인 시 자동 실행되도록 등록한다.",
    "keywords": [
    "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run",
    "AppData\\Local\\**\\*.exe",
    "autorun",
    "registry persistence"
    ]
  },
  {
    "category": "Persistence",
    "subcategory": "Run_HKLM",
    "description": "HKLM Run 키로 모든 사용자 로그인 시 자동 실행되도록 등록한다.",
    "keywords": [
    "HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run",
    "C:\\ProgramData\\**\\*.exe",
    "autorun all users"
    ]
  },
  {
    "category": "Persistence",
    "subcategory": "Run_HKCU_Wow6432Node",
    "description": "HKCU Wow6432Node Run 키를 이용해 32비트 컨텍스트로 실행되도록 등록한다.",
    "keywords": [
      "HKCU\\Software\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Run",
      "AppData\\Local\\**\\*.exe",
      "run 32-bit"
    ]
  },
  {
    "category": "Persistence",
    "subcategory": "Run_HKLM_Wow6432Node",
    "description": "HKLM Wow6432Node Run 키를 이용해 시스템 전역 32비트 실행을 등록한다.",
    "keywords": [
      "HKLM\\Software\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Run",
      "C:\\ProgramData AND .exe",
      "run 32-bit global"
    ]
  },
  {
    "category": "Persistence",
    "subcategory": "RunOnce_HKCU",
    "description": "HKCU RunOnce 키로 다음 로그인에서 1회 실행되도록 등록한다.",
    "keywords": [
      "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce",
      "RegExpandSz",
      "\\AppData\\Roaming\\**\\*.exe",
      "one-time run"
    ]
  },
  {
    "category": "Persistence",
    "subcategory": "RunOnce_HKLM",
    "description": "HKLM RunOnce 키로 시스템 전역 1회 실행을 등록한다.",
    "keywords": [
      "Windows\\CurrentVersion\\RunOnce",
      "C:\\ProgramData\\**\\*.exe",
      "one-time run all users"
    ]
  },
    {
    "category": "Persistence",
    "subcategory": "RunOnce_HKLM",
    "description": "HKLM RunOnce 키로 시스템 전역 1회 실행을 등록한다.",
    "keywords": [
      "Windows\\CurrentVersion\\RunOnce",
      "C:\\ProgramData\\**\\*.exe",
      "one-time run all users"
    ]
  },
{
    "category": "Persistence",
    "subcategory": "Run_HKLM_UserArea",
    "description": "HKLM Run 키가 사용자 프로필 경로를 가리키도록 등록한다.",
    "keywords": [
      "HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run AND ValueName=*",
      "HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run AND ValueData LIKE C:\\\\Users\\\\<USER>\\\\AppData\\\\%",
      "%APPDATA% OR %LOCALAPPDATA% in HKLM Run",
      "autorun all users"
    ]
  },
  {
    "category": "Persistence",
    "subcategory": "Run_HKCU",
    "description": "HKCU Run 키로 사용자 로그인 시 자동 실행되도록 한다.",
    "keywords": [
      "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run AND ValueName=*",
      "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run AND ValueData=*"
    ]
  },
  [
{
    "category": "Persistence",
    "subcategory": "AppInit_DLLs_List",
    "description": "AppInit_DLLs 값에 등록된 DLL 목록을 확인한다.",
    "keywords": [
    "Microsoft\\Windows NT\\CurrentVersion\\Windows AND AppInit_DLLs",
    "SoftWow6432Node\\Microsoft\\Windows NT\\CurrentVersion\\Windows AND AppInit_DLLs"
    ]
  },
  {
    "category": "Persistence",
    "subcategory": "AppInit_Enable",
    "description": "LoadAppInit_DLLs가 활성(1)인지 확인한다.",
    "keywords": [
    "Microsoft\\Windows NT\\CurrentVersion\\Windows AND LoadAppInit_DLLs",
    "Wow6432Node\\Microsoft\\Windows NT\\CurrentVersion\\Windows AND LoadAppInit_DLLs"
    ]
  },
  {
    "category": "Persistence",
    "subcategory": "AppInit_Signature_Policy",
    "description": "RequireSignedAppInit_DLLs 정책을 확인한다.",
    "keywords": [
    "Microsoft\\Windows NT\\CurrentVersion\\Windows AND RequireSignedAppInit_DLLs",
    "Wow6432Node\\Microsoft\\Windows NT\\CurrentVersion\\Windows AND RequireSignedAppInit_DLLs"
    ]
  },
  {
    "category": "Persistence",
    "subcategory": "AppInit_MultiDLL_Separator",
    "description": "AppInit_DLLs에 공백으로 구분된 다중 DLL 등록 여부를 확인한다.",
    "keywords": [
    "AppInit_DLLs AND .dll .dll",
    "AppInit_DLLs AND ;",
    "AppInit_DLLs AND ,"
    ]
  },
  [
  {
  "category": "Persistence",
  "subcategory": "Winlogon_Shell_Modification",
  "description": "Winlogon Shell 값을 변경해 로그인 시 임의 프로세스를 실행되게 한다.",
  "keywords": [
    "HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon AND Shell",
    "HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon AND Shell",
    "HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System AND Shell",
    "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System AND Shell",
    "Shell AND C:\\\\Users\\\\<USER>\\\\AppData\\\\%",
    "Shell AND C:\\\\ProgramData\\\\%",
    "Shell AND \\\\<host>\\share\\*.exe"
  ]
},
{
  "category": "Persistence",
  "subcategory": "Winlogon_Userinit_Modification",
  "description": "Userinit 값에 추가 실행 파일을 덧붙여 로그인 시 로드되게 한다.",
  "keywords": [
    "HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon AND Userinit",
    "HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon AND Userinit",
    "Userinit AND C:\\\\Users\\\\<USER>\\\\AppData\\\\%",
    "Userinit AND C:\\\\ProgramData\\\\%",
    "Userinit AND \\\\<host>\\share\\*.exe"
  ]
},
{
  "category": "Persistence",
  "subcategory": "Winlogon_Notify_Package",
  "description": "Winlogon\\Notify 하위에 DLL 패키지를 등록해 로그인 이벤트 시 로드되게 한다.",
  "keywords": [
    "HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Notify\\{Key} AND DllName",
    "DllName AND C:\\\\Users\\\\<USER>\\\\AppData\\\\%",
    "DllName AND C:\\\\ProgramData\\\\%",
    "DllName AND \\\\<host>\\share\\*.dll"
  ]
},
  {
    "category": "Persistence",
    "subcategory": "Winlogon_Shell_Suspicious_Path",
    "description": "Shell 또는 Userinit 경로가 사용자/공용/UNC 등 비표준 위치인지 확인한다.",
    "keywords": [
      "Shell AND C:\\\\Users\\\\<USER>\\\\AppData\\\\%",
      "Userinit AND C:\\\\Users\\\\<USER>\\\\AppData\\\\%",
      "Shell AND C:\\\\ProgramData\\\\%",
      "Userinit AND \\\\ <host> \\share\\*.exe"
    ]
  },
  [
  {
  "category": "Persistence",
  "subcategory": "LSA_Authentication_Packages",
  "description": "Authentication Packages에 DLL을 추가해 LSASS 로드되게 한다.",
  "keywords": [
    "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa AND Authentication Packages",
    "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\OSConfig AND Authentication Packages",

    "ControlSet001\\Control\\Lsa AND Authentication Packages",
    "ControlSet001\\Control\\Lsa AND Notification Packages",
    "ControlSet001\\Control\\Lsa AND Security Packages",

    "Authentication Packages AND msv1_0",
    "Notification Packages AND scecli",
    "Security Packages AND \"\"",

    "Authentication Packages AND *.dll",
    "Notification Packages AND *.dll",
    "Security Packages AND *.dll",

    "Authentication Packages AND \\\\",
    "Notification Packages AND \\\\",
    "Security Packages AND \\\\",

    "Authentication Packages AND C:\\\\Users\\\\<USER>\\\\AppData\\\\",
    "Authentication Packages AND C:\\\\ProgramData\\\\",
    "Authentication Packages AND \\\\ <host> \\share\\*.dll"
  ]
},
 [
  {
    "category": "Persistence",
    "subcategory": "LSA_Security_Packages",
    "description": "Security Packages에 DLL을 추가해 SSPI 체인에 주입한다.",
    "keywords": [
      "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa AND Security Packages",
      "ControlSet001\\Control\\Lsa AND Security Packages",
      "Security Packages AND *.dll",
      "Security Packages AND \\\\",
      "Security Packages AND C:\\\\Users\\\\<USER>\\\\AppData\\\\",
      "Security Packages AND C:\\\\ProgramData\\\\",
      "Security Packages AND \"\"" 
    ]
  },
  {
    "category": "Persistence",
    "subcategory": "LSA_Notification_Packages",
    "description": "Notification Packages에 DLL을 추가해 로그인 이벤트 시 로드되게 한다.",
    "keywords": [
      "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa AND Notification Packages",
      "ControlSet001\\Control\\Lsa AND Notification Packages",
      "Notification Packages AND *.dll",
      "Notification Packages AND \\\\",
      "Notification Packages AND C:\\\\ProgramData\\\\",
      "Notification Packages AND C:\\\\Users\\\\<USER>\\\\AppData\\\\",
      "Notification Packages AND \"\""  
    ]
  },
  {
    "category": "Persistence",
    "subcategory": "SecurityProviders_SSPI_Chain",
    "description": "SecurityProviders 값에 DLL을 추가해 SSPI 체인을 가로채게 한다.",
    "keywords": [
      "HKLM\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders AND SecurityProviders",
      "ControlSet001\\Control\\SecurityProviders AND SecurityProviders",
      "SecurityProviders AND *.dll",
      "SecurityProviders AND \\\\",
      "SecurityProviders AND C:\\\\Users\\\\<USER>\\\\AppData\\\\",
      "SecurityProviders AND C:\\\\ProgramData\\\\"
    ]
  },
  {
    "category": "Persistence",
    "subcategory": "LSA_RunAsPPL_Bypass_Context",
    "description": "LSA 주입 경로가 PPL 보호 우회를 노리는지 점검한다.",
    "keywords": [
      "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa AND RunAsPPL",
      "LSASS AND ProtectedProcessLight",
      "RunAsPPL AND Disable",
      "LSA injection context check"
    ]
  }
]

]
]
]
]